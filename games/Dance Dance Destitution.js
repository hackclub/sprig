/*
@title: Dance Dance Destitution
@author: Ovane
@tags: []
@addedOn: 1943-02-34
*/
setLegend(
  ["U", bitmap`
................
.......88.......
......8888......
.....888888.....
....88888888....
...8888888888...
......8888......
......8888......
......8888......
......8888......
......8888......
......8888......
......8888......
......8888......
......8888......
................` ],
  ["D", bitmap`
................
......4444......
......4444......
......4444......
......4444......
......4444......
......4444......
......4444......
......4444......
......4444......
...4444444444...
....44444444....
.....444444.....
......4444......
.......44.......
................` ],
  ["L", bitmap`
................
................
................
.....9..........
....99..........
...999..........
..9999999999999.
.99999999999999.
.99999999999999.
..9999999999999.
...999..........
....99..........
.....9..........
................
................
................` ],
  ["R", bitmap`
................
................
................
..........3.....
..........33....
..........333...
.3333333333333..
.33333333333333.
.33333333333333.
.3333333333333..
..........333...
..........33....
..........3.....
................
................
................` ],
  ["u", bitmap`
0000000000000000
0000000220000000
0000002222000000
0000022222200000
0000222222220000
0002222222222000
0000002222000000
0000002222000000
0000002222000000
0000002222000000
0000002222000000
0000002222000000
0000002222000000
0000002222000000
0000002222000000
0000000000000000` ],
  ["d", bitmap`
0000000000000000
0000002222000000
0000002222000000
0000002222000000
0000002222000000
0000002222000000
0000002222000000
0000002222000000
0000002222000000
0000002222000000
0002222222222000
0000222222220000
0000022222200000
0000002222000000
0000000220000000
0000000000000000` ],
  ["l", bitmap`
0000000000000000
0000000000000000
0000000000000000
0000020000000000
0000220000000000
0002220000000000
0022222222222220
0222222222222220
0222222222222220
0022222222222220
0002220000000000
0000220000000000
0000020000000000
0000000000000000
0000000000000000
0000000000000000` ],
  ["r", bitmap`
0000000000000000
0000000000000000
0000000000000000
0000000000200000
0000000000220000
0000000000222000
0222222222222200
0222222222222220
0222222222222220
0222222222222200
0000000000222000
0000000000220000
0000000000200000
0000000000000000
0000000000000000
0000000000000000` ],
  ["s",bitmap`
1111111001111111
1111111001111111
1111111001111111
1111111001111111
1111111001111111
1111111001111111
1111111001111111
1111111001111111
1111111001111111
1111111001111111
1111111001111111
1111111001111111
1111111001111111
1111111001111111
1111111001111111
1111111001111111`],
  ["p",bitmap`
8555555885555500
5855588778855500
5585877777785800
5558777777778500
5587876776787800
5877787667877700
5877678558767700
8777765225677700
8777765225677700
5877678558767700
5877787667877700
5587876776787800
5558777777778500
5585877777785800
5855588778855500
8555555885555500`],
  ["P",bitmap`
0055555885555558
0055588778855585
0085877777785855
0058777777778555
0087876776787855
0077787667877785
0077678558767785
0077765225677778
0077765225677778
0077678558767785
0077787667877785
0087876776787855
0058777777778555
0085877777785855
0055588778855585
0055555885555558`],
  ["B",bitmap`
8555555885555558
5855588778855585
5585877777785855
5558777777778555
5587876776787855
5877787667877785
5877678558767785
8777765225677778
8777765225677778
5877678558767785
5877787667877785
5587876776787855
5558777777778555
5585877777785855
5855588778855585
8555555885555558`],
  ["C",bitmap`
8500HHHHHHHHHHHH
5800HHHHHHHHHHHH
5500HHHHHHHHHHHH
5500HHHHHHHHHHHH
5500HHHHHHHHHHHH
5800HHHHHHHHHHHH
5800HHHHHHHHHHHH
8700HHHHHHHHHHHH
8700HHHHHHHHHHHH
5800HHHHHHHHHHHH
5800HHHHHHHHHHHH
5500HHHHHHHHHHHH
5500000000000000
5500000000000000
5855588778855585
8555555885555558`],
  ["E",bitmap`
8555555885555558
5855588778855585
5500000000000000
5500000000000000
5500HHHHHHHHHHHH
5800HHHHHHHHHHHH
5800HHHHHHHHHHHH
8700HHHHHHHHHHHH
8700HHHHHHHHHHHH
5800HHHHHHHHHHHH
5800HHHHHHHHHHHH
5500HHHHHHHHHHHH
5500HHHHHHHHHHHH
5500HHHHHHHHHHHH
5800HHHHHHHHHHHH
8500HHHHHHHHHHHH`],
  ["F",bitmap`
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
0000000000000000
0000000000000000
5855588778855585
8555555885555558`],
  ["G",bitmap`
8555555885555558
5855588778855585
0000000000000000
0000000000000000
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH
HHHHHHHHHHHHHHHH`],
  ["H",bitmap`
HHHHHHHHHHHH0058
HHHHHHHHHHHH0085
HHHHHHHHHHHH0055
HHHHHHHHHHHH0055
HHHHHHHHHHHH0055
HHHHHHHHHHHH0085
HHHHHHHHHHHH0085
HHHHHHHHHHHH0078
HHHHHHHHHHHH0078
HHHHHHHHHHHH0085
HHHHHHHHHHHH0085
HHHHHHHHHHHH0055
0000000000000055
0000000000000055
5855588778855585
8555555885555558`],
  ["I",bitmap`
8555555885555558
5855588778855585
0000000000000055
0000000000000055
HHHHHHHHHHHH0055
HHHHHHHHHHHH0085
HHHHHHHHHHHH0085
HHHHHHHHHHHH0078
HHHHHHHHHHHH0078
HHHHHHHHHHHH0085
HHHHHHHHHHHH0085
HHHHHHHHHHHH0055
HHHHHHHHHHHH0055
HHHHHHHHHHHH0055
HHHHHHHHHHHH0085
HHHHHHHHHHHH0058`],
)
let level = 0
const levels = [
  map`
EGGIssssPBBB
CFFHssssPBBB
BBBpssssPBBB
BBBpssssPBBB
BBBpssssPBBB
BBBpssssPBBB
BBBpudlrPBBB
BBBpssssPBBB
BBBpssssPBBB`
]
let arrows = [];
let played=0;
let song=[]
setSongToTune(tune`
500: C4~500,
500: D4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: E4~500,
500: D4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: E4~500,
500: E4~500,
500: D4~500,
500: D4~500,
500: F4~500,
500: F4~500,
500: C4~500,
500: C4~500`);
setSongToTune(tune`
500: C4~500,
500: C4~500,
500: C4~500,
500: D4~500,
500: D4~500,
500: D4~500,
500: D4~500,
500: E4~500,
500: E4~500,
500: E4~500,
500: E4~500,
500: F4~500,
500: F4~500,
500: F4~500,
500: F4~500,
500: E4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: C4~500,
500: D4~500,
500: F4~500,
500: E4~500,
500: C4~500,
500: D4~500,
500: D4~500,
500: E4~500,
500: D4~500,
500: D4~500`);
setSongToTune(tune`
500: D4~500,
500: E4~500,
500: C4~500,
500: F4~500,
500: E4~500,
500: C4~500,
500: D4~500,
500: D4~500,
500: E4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: D4~500,
500: E4~500,
500: F4~500,
500: E4~500,
500: F4~500,
500: E4~500,
500: C4~500,
500: D4~500,
500: C4~500,
500: C4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: D4~500`);
setSongToTune(tune`
500: F4~500,
500: E4~500,
500: D4~500,
500: D4~500,
500: E4~500,
500: F4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: D4~500,
500: E4~500,
500: C4~500`);
setSongToTune(tune`
500: D4~500,
500: E4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: F4~500,
500: F4~500,
500: E4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: D4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: E4~500,
500: E4~500,
500: F4~500,
500: F4~500,
500: F4~500`);

setSongToTune(tune`
500: D4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: F4~500,
500: E4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: F4~500,
500: E4~500 + C4~500,
500: D4~500,
500: E4~500,
500: E4~500,
500: E4~500,
500: D4~500,
500: E4~500,
500: E4~500,
500: D4~500,
500: E4~500,
500: E4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: E4~500,
500: D4~500,
500: E4~500`);
setSongToTune(tune`
500: C4~500,
500: C4~500,
500: C4~500,
500: D4~500,
500: D4~500,
500: D4~500,
500: E4~500,
500: E4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: F4~500,
500: F4~500,
500: F4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: E4~500,
500: F4~500,
500: F4~500,
500: F4~500,
500: F4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: E4~500`);
setSongToTune(tune`
500: D4~500,
500: D4~500,
500: E4~500,
500: C4~500,
500: D4~500,
500: F4~500,
500: E4~500,
500: F4~500,
500: F4~500,
500: F4~500,
500: E4~500,
500: F4~500,
500: C4~500,
500: C4~500,
500: D4~500,
500: C4~500,
500: C4~500,
500: C4~500,
500: C4~500 + E4~500,
500: E4~500,
500: E4~500,
500: F4~500,
500: E4~500 + C4~500,
500: D4~500,
500: D4~500,
500: C4~500,
500: D4~500 + F4~500,
500: E4~500,
500: E4~500,
500: E4~500,
500: C4~500,
500: D4~500`);
setSongToTune(tune`
500: C4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: F4~500,
500: F4~500,
500: F4~500,
500: F4~500,
500: E4~500,
500: F4~500,
500: D4~500,
500: C4~500,
500: C4~500,
500: C4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: D4~500,
500: D4~500,
500: D4~500,
500: C4~500,
500: C4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: F4~500,
500: F4~500,
500: F4~500,
500: D4~500`);
setSongToTune(tune`
500: D4~500,
500: C4~500,
500: C4~500,
500: C4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: C4~500,
500: C4~500,
500: F4~500,
500: E4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: C4~500,
500: D4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: F4~500,
500: E4~500,
500: E4~500,
500: F4~500,
500: D4~500,
500: C4~500,
500: C4~500,
500: C4~500,
500: D4~500,
500: D4~500,
500: C4~500`);

setSongToTune(tune`
500: C4~500,
500: C4~500,
500: D4~500,
500: D4~500,
500: D4~500,
500: E4~500,
500: E4~500,
500: E4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: C4~500,
500: C4~500,
500: C4~500,
500: D4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: F4~500,
500: E4~500,
500: F4~500,
500: E4~500,
500: D4~500,
500: E4~500,
500: F4~500,
500: F4~500,
500: E4~500,
500: E4~500,
500: D4~500,
500: C4~500,
500: C4~500`);
let run;
let notes = {U:tune`
500: C5~500,
15500`,D:tune`
500: E5~500,
15500`,L:tune`
500: G5~500,
15500`,R:tune`
500: undefined~500 + B5~500,
15500`}
let xs = {U:4,D:5,L:6,R:7}
run = setInterval(()=>{
  for (let i in arrows) {
    let tiles = getTile(xs[arrows[i].type],arrows[i].y);
    for (let j in tiles) {
      if (["U","D","L","R"].includes(tiles[j].type)) {
        tiles[j].remove();
      }
    }
    arrows[i].y++;
    if (arrows[i].y==6) {
      playTune(notes[arrows[i].type]);
    }
    if (arrows[i].y>8) {
      arrows.splice(i,1)
    } else {
    addSprite(xs[arrows[i].type],arrows[i].y,arrows[i].type)
    }
  }
  clearText();
  let colour = Math.round(played*(100/song.length))<=10?color`3`:Math.round(played*(100/song.length))<=30?color`6`:Math.round(played*(100/song.length))<=50?color`4`:Math.round(played*(100/song.length))<=75?color`9`:Math.round(played*(100/song.length))<=99?color`8`:color`7`;
  addText(`${Math.round(played*(100/song.length))}%`,{x:2,y:2,color:colour});
},200);
for (let i in song) {
  setTimeout(()=>{arrows.push({type:{C4:"U",D4:"D",E4:"L",F4:"R"}[song[i][0]],y:0})},song[i][1]*200);
}
setMap(levels[level])
onInput("w", () => {
  if (getTile(4,6)[0].type=="U") {
    played++;
  }
})
onInput("s", () => {
  if (getTile(5,6)[0].type=="D") {
    played++;
  }
})
onInput("a", () => {
  if (getTile(6,6)[0].type=="L") {
    played++;
  }
})
onInput("d", () => {
  if (getTile(7,6)[0].type=="R") {
    played++;
  }
})
afterInput(() => {
  
})
function setSongToTune(tune) {
  for (let line in tune.split("\n")) {
    if (line>0&&line<tune.split("\n").length-1) {
    let sides = tune.split("\n")[line].split(": ");
      let note = sides[1].split("~")[0];
      song.push([note,song.length])
    }
  }
}