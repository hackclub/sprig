/*
@title: CatchTheCat
@author: PrathamGhaywat
@description: A game where you try to catch a cat
@tags: [#cat, #catch]
@addedOn: 2025-08-12 
*/


const player = "p"
const cat = "c"
const grass = "g"

setLegend(
  [player, bitmap`
....6666........
...66666........
...666666.......
..66666666......
..66666666......
..66666666......
..66666666......
...666666.......
...666666.......
....6666........
....6666........
....6666........
....6666........
....6666........
....6666........
....6666........`],
  [cat, bitmap`
................
................
................
................
..9........9....
.989......989...
.989999999989...
..9666666669....
..9969669699....
...96666669.....
...99666699.....
....996699......
.....9999.......
................
................
................`],
  [grass, bitmap`
4444444444444444
4444444444444444
4444444444444444
4444444444444444
4444444444444444
4444444444444444
4444444444444444
4444444444444444
4444444444444444
4444444444444444
4444444444444444
4444444444444444
4444444444444444
4444444444444444
4444444444444444
4444444444444444`]
)

setBackground(grass)

const playerStart = [7, 7]
const catStart = [3, 3]

let catPos = [...catStart]

setSolids([player])

let level = map`
................
................
................
................
................
................
................
................
................
................
................
................
................
................
................
................`


setMap(level)

addSprite(playerStart[0], playerStart[1], player)
addSprite(catStart[0], catStart[1], cat)

function randomCatMove() {
  const x = Math.floor(Math.random() * 16)
  const y = Math.floor(Math.random() * 16)
  clearTile(catPos[0], catPos[1])
  addSprite(x, y, cat)
  catPos = [x, y]
}

onInput("w", () => {
  getFirst(player).y -= 1
})
onInput("s", () => {
  getFirst(player).y += 1
})
onInput("a", () => {
  getFirst(player).x -= 1
})
onInput("d", () => {
  getFirst(player).x += 1
})

afterInput(() => {
  const p = getFirst(player)
  const c = getFirst(cat)
  if (p.x === c.x && p.y === c.y) {
    addText("You caught the cat!", {
      x: 4,
      y: 7,
      color: color`3`
    })
    setTimeout(() => {
      clearText()
      clearTile(getFirst(player).x, getFirst(player).y)
      clearTile(catPos[0], catPos[1])
      setMap(level)
      addSprite(playerStart[0], playerStart[1], player)
      addSprite(catStart[0], catStart[1], cat)
      catPos = [...catStart]
    }, 2000)
  }
})
setInterval(() => {
  randomCatMove()
}, 3000)
