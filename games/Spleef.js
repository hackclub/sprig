//controls all assets
setLegend(
    ['p',bitmap`
6666666666666666
6666666666666666
6666666666666666
6666666666666666
6666666666666666
6666666666666666
6666666666666666
6666666666666666
6666666666666666
6666666666666666
6666666666666666
6666666666666666
6666666666666666
6666666666666666
6666666666666666
6666666666666666`], // Player
    ['b',bitmap`
7777777777777777
7777777777777777
7777777777777777
7777777777777777
7777777777777777
7777777777777777
7777777777777777
7777777777777777
7777777777777777
7777777777777777
7777777777777777
7777777777777777
7777777777777777
7777777777777777
7777777777777777
7777777777777777`], // bg
    ['x',bitmap`
................
................
................
................
................
................
................
................
................
................
................
................
................
................
................
................`], // box
    ['s',bitmap`
2222222222222222
2222222222222222
2222222222222222
2222222222222222
2222222222222222
2222222222222222
2222222222222222
2222222222222222
2222222222222222
2222222222222222
2222222222222222
2222222222222222
2222222222222222
2222222222222222
2222222222222222
2222222222222222`] // snow?
)

//controls all maps
const maps = [
    map`
............
............
............
............
............
............
............
............
............
............
............
............`
]

//set everything up
var p;
var width;
var height;

function start(){
    setMap(maps[0])
    setBackground('b')

    width = 12
    height = width

    for (let x = 0; x<width;x++){
        for (let y = 0; y<height;y++){
            clearTile()
        }
    }

    for (let x = 0; x<width;x++){
        for (let y = 0; y<height;y++){
            addSprite(x,y,'s')
        }
    }

    addSprite(0,0,'p')
    p = getFirst('p')
}

start()

//movement manager
var x;
var y;

onInput("w", () => {
    x = p.x
    y = p.y
    p.y -= 1
    if (y!=p.y){
        clearTile(x,y)
    }
})
onInput("a", () => {
    x = p.x
    y = p.y
    p.x -= 1
    if (x!=p.x){
        clearTile(x,y)
    }
})
onInput("s", () => {
    x = p.x
    y = p.y
    p.y += 1
    if (y!=p.y){
        clearTile(x,y)
    }
})
onInput("d", () => {
    x = p.x
    y = p.y
    p.x += 1
    if (x!=p.x){
        clearTile(x,y)
    }
})

//death checker
afterInput(e=>{
    x = p.x
    y = p.y
    let life = (getTile(x,y).length>=2)

    if (!life){
        start()
    }
})