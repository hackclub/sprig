
/*
@title: RPG
@author: Me_Myself_and_I
@description: A basic rpg that I made. There includes a camera that follows you, an inventory system, enemies, upgrade system, and more.
@tags: ["rpg"]
@addedOn: 2025-11-20
*/

/*
Sorry if this code is hard to read
And I'm not good a documenting my code

  Equipable slots:
    head
    back
    body
    hands
    feet
    
  Maps
    Map name
      map: a grid made of lists of lists with evey tile being a string with every bitmap names and spaces.
      background: the background bitmap name
      
  interactions
    bitmap name: function that takes two parameters that is x,y and only gets called when the player walks into that sprite
    Map name
      bitmap name: same as the one out but only gets called when the map is the one this is in
      x,y: function that takes a parameter that is true if it is not directly activated by the player  and returns [new map name, new x, new y, push direction]
*/


// This object is for debugging / adding things to the game
const debug = {
  // Just log the pos / map so I know
  logPos: false,
  logMap: false,
  // Makes you invincible and walk trough anything and spend more than you have
  OP: false,
};

// These are pretty self eplanitory
const solid = ["⊟", "⌂", "△", "⦰", "⊞", "⊠", "⌧", "d", "t", "C", "◻", "e", "T", "|", "/", "@", "♜", "♖", "E", "m", "w", "M", "℥"];
const pushable = ["⌧", "◻"];
const collectable = ["h", "B", "♥", "k", "K", "Ⅎ", "!", "#", "←", "↑", "→", "↓", "↔"];
// It goes thing you want to be able to break: thing you want to replace it with
const breakable = { "⌧": "⌬", "⊞": "⊠" };

// The camera overlay / size
const camera = map`
..........
..........
..........
..........
..........
..........
..........
..........`;

// Starting values
let start = {
  ingame: true,
  // All the maps reset
  maps: {
    "Default": {
      map: [
        ["P⌂", "P", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P"],
        [" ", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P", "P"],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "P", "P", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "P", "P", "⊟", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        [" ", " ", " ", " ", " ", " ", "e", " ", " ", " ", " ", "P", "P", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T", "T"],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "⊟", "P", "P", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T", "T"],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "P", "P", " ", " ", " ", " ", " ", "e", " ", " ", " ", " ", "T", "T"],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "P", "P", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "P", "P", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        [" ", " ", " ", " ", "e", " ", " ", " ", " ", " ", " ", "P", "P", "⊟", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T", "T"],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "P", "P", " ", " ", " ", "e", " ", " ", " ", " ", " ", " ", "T", "T"],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "⊟", "P", "P", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "P", "P", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T", "T"],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "P", "P", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "P", "P", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", "e", " ", " ", " ", " ", " ", " ", " ", " ", "P", "P", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "P", "P", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", "&", " ", " ", "&", "&", " ", "P", "P", " ", "&", "&", "&", " ", "&", " ", "&", "&", " ", " ", " "],
        ["k", " ", "&", "&", "&", "&", "&", "&", "&", "&", "&", "&P", "&P", "&", "&", "&", "&", "&", "&", "&", "&", "&", "&", " ", " "],
      ],
      background: "g",
    },

    "Forest": {
      map: [
        ["T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", " ", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", " "],
        ["P", "P", "PE", "P", "P", "T", "T", "T", " ", "T", "T", "T", "T", " ", "T", "T", "T", "T", "T", "T", " ", "T", "T", " ", " "],
        ["P", "P", "P", "P", "P", "P", "T", "T", "T", "T", "T", "T", "T", " ", " ", "T", "T", "T", " ", "T", "T", "T", " ", " ", "T"],
        ["T", "T", "T", "T", "P", "P", "T", "T", "T", " ", "T", "T", "T", "T", " ", " ", "T", "T", "T", "T", "T", " ", " ", "T", "T"],
        ["T", " ", "T", "T", "PE", "P", "T", "T", "T", "T", "T", "T", "T", "T", "T", " ", " ", "T", " ", "T", " ", " ", "T", "T", "T"],
        ["T", "T", " ", "T", "P", "P", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", " ", "T", "T", " ", " ", "T", "T", "T", "T"],
        ["T", "T", "T", "T", "P", "P", "T", "T", "T", " ", "T", "T", " ", " ", " ", "T", " ", "T", " ", " ", "T", "T", " ", "T", "T"],
        ["T", " ", "T", "T", "P", "P", " ", " ", "T", "T", "T", " ", " ", "T", " ", " ", " ", " ", " ", "T", "T", "T", "T", "T", "T"],
        ["T", "T", "T", "T", "P", "P", "T", " ", " ", "T", " ", " ", "T", "T", "T", " ", "T", " ", "T", "T", "T", "T", "T", "T", "T"],
        ["T", "T", " ", "T", "P", "P", "T", "T", " ", " ", " ", "T", "T", "T", " ", " ", "T", " ", " ", "T", " ", "T", "T", " ", " "],
        ["T", " ", " ", "T", "P", "PE", "T", "T", "T", "T", "T", "T", "T", "T", " ", "T", "T", "T", " ", "T", "T", "T", " ", " ", "T"],
        ["T", "T", "T", "T", "P", "P", "T", "T", "T", "T", "T", " ", "T", " ", " ", "T", "T", "T", " ", "T", " ", " ", " ", "T", "T"],
        ["T", "T", "T", "T", "P", "P", "T", "T", "T", "T", "T", "T", " ", " ", "T", "T", "T", "T", " ", " ", " ", "T", " ", "T", " "],
        ["T", "T", "T", "T", "P", "P", "T", "T", "T", "T", "T", "T", " ", "T", "T", "T", "T", " ", "T", "T", "T", "T", " ", "T", "T"],
        ["T", "T", " ", "T", "P", "P", "T", " ", "T", "T", "T", "T", " ", " ", "T", "T", "T", "T", "T", "T", " ", "T", " ", " ", "T"],
        ["T", "T", "T", "T", "P", "P", "T", "T", "T", " ", "T", "T", "T", " ", "T", "T", "T", "T", " ", "T", "T", "T", "T", " ", "T"],
        ["T", "T", "T", "T", "P", "P", "T", "T", "T", "T", "T", "T", " ", " ", "T", "T", " ", "T", "T", "T", " ", " ", "T", " ", "T"],
        ["T", "T", "T", "T", "PE", "P", "T", "T", "T", "T", "T", " ", " ", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", " ", "T"],
        ["T", "T", "T", "T", "P", "P", "T", "T", "T", "T", " ", " ", "T", "T", "T", "T", "T", "T", " ", "T", "T", "T", " ", " ", "T"],
        ["T", " ", "T", "T", "P", "P", "T", "T", "T", "T", " ", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", " ", " ", "T", "T"],
        ["T", "T", "T", "T", "P", "P", "T", "T", " ", "T", " ", " ", "T", "T", " ", "T", "T", "T", "T", "T", " ", " ", "T", "T", " "],
        ["T", "T", " ", "T", "PE", "P", "T", "T", "T", "T", "T", " ", "T", "T", "T", "T", "T", " ", "T", "T", " ", "T", "T", "T", "T"],
        ["T", "T", "T", "T", "P", "P", "T", " ", "T", "T", " ", " ", "T", "T", "T", " ", "T", "T", "T", "T", " ", "T", " ", "T", "T"],
        ["T", " ", "T", "T", "P", "P", "T", "T", "T", "T", " ", "T", "T", " ", "T", "T", "T", "T", "T", " ", " ", "T", "T", "T", "T"],
        ["T", "T", "T", "T", "P", "P", "T", "T", "T", " ", " ", "T", "T", "T", "T", "T", "T", "T", "T", " ", "T", "T", "T", " ", "T"],
      ],
      background: "g",
    },
    "Forest Secret": {
      map: [
        ["T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "E", "T", "T", "T", "T", "T"],
        ["T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", " ", " ", "T", "T", " ", "T"],
        [" ", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", " ", "T", "T", "T", " ", " ", "T", "T", "T"],
        ["T", "T", " ", " ", "T", "T", " ", "T", "T", "T", "T", "T", "T", " ", "T", "T", " ", " ", "T", "T"],
        ["T", "T", "T", "T", "T", "T", "T", "T", "T", " ", "T", "T", "T", "T", "T", " ", "T", " ", " ", "T"],
        ["T", " ", "T", "T", "T", " ", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "⌧", "T"],
        ["T", "T", "T", "T", "T", "T", "T", " ", "T", " ", "T", "T", " ", "T", " ", "T", "T", "T", " ", "T"],
        ["T", "T", "T", "T", " ", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", " ", "T", " ", "T"],
        ["T", "T", "T", "T", "T", "T", "T", "T", " ", "T", "T", "T", "T", "T", "T", " ", "T", "T", " ", "T"],
        ["T", "T", " ", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", " ", "T", "T", "T", "T", " ", "T"],
        ["T", "T", "T", " ", " ", " ", " ", " ", "⊟", "T", "T", " ", "T", "T", "T", "T", "T", "T", " ", "T"],
        ["T", "T", " ", " ", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", " ", "T", "T", " ", "T"],
        ["T", "T", " ", "T", "T", "T", " ", "T", " ", "T", "T", "T", " ", "T", "T", "T", "T", "T", " ", "T"],
        ["T", "T", " ", "T", " ", "T", "T", "T", "T", "T", "T", "T", "T", " ", "T", "T", "T", " ", " ", "T"],
        ["T", "T", " ", " ", "T", "T", "T", "T", "T", " ", "T", "T", "T", "T", "T", "T", " ", " ", "T", "T"],
        ["T", "T", "T", " ", " ", "T", " ", "T", "T", "T", "T", " ", "T", "T", "T", " ", " ", "T", "T", " "],
        ["T", "T", "T", "T", " ", " ", "T", "T", "T", "T", "T", "T", "T", "T", " ", " ", "T", "T", "T", "T"],
        ["T", "T", "T", "T", "T", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T", "T", "T", " ", "T"],
        ["T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", " ", "T", "T", "T"],
      ],
      background: "g",
    },
    "Forest Secret Home": {
      map: [
        ["⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰"],
        ["⦰", "k", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "t", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "c", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⌧", "e", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰d", " ", "E", " ", " ", " ", " ", " ", " ", "⌧", "e", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⌧", "e", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", "k", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "k", "⦰"],
        ["⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰"],
      ],
      background: "G",
    },

    "Forest Clearing": {
      map: [
        ["T", "⚪T", "T", "T", "T", "T", "T", "T", "T", "P", "P", "T", "T", "T", "T", "T", "T", "T", "T", "T"],
        ["⚪T", "⚪@", "⚪", "⚪", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["⚪T", "⚪", "⚪", "⚪", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", "⚪", "⚪", "⚪", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", " ", "⚪", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", " ", " ", " ", " ", " ", "E", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "E", " ", " ", " ", " ", "T"],
        ["T", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", " ", " ", " ", " ", " ", " ", " ", " ", " ", "E", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", " ", "E", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", " ", " ", " ", " ", " ", " ", " ", "E", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "T"],
        ["T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T", "T"],
      ],
      background: "g",
    },
    "Mine": {
      map: [
        ["s", " ", " ", " ", " ", "M", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", "M", " ", " ", " ", " ", "M", " ", " "],
        [" ", " ", " ", " ", "⌧", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        ["M", " ", "M", " ", " ", "M", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", "M", " ", " ", " ", " ", "M", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", "M"],
        ["k", " ", " ", " ", " ", " ", " ", " ", "M", "♜"],
      ],
      background: "⚪",
    },

    "Beach": {
      map: [
        ["g", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "P", "P", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "g"],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "*", "*", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", "△", " ", " ", "*", "*", " ", " ", " ", " ", " ", "m", " ", " ", " ", " ", " ", " "],
        [" ", " ", "m", " ", " ", " ", " ", " ", " ", " ", " ", "*", "*", " ", " ", "△", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", "△", " ", " ", " ", " ", " ", " ", "*", "*", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "*", "*", " ", " ", " ", " ", " ", " ", " ", "△", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "*", "*", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "*", "*", " ", " ", "m", " ", " ", " ", " ", " ", " ", "△", " ", " "],
        [" ", " ", "⌧", " ", " ", " ", " ", " ", " ", " ", " ", "*", "*", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", "△", " ", " ", " ", " ", "*", "*", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "*", "*", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "*", "*", " ", " ", " ", " ", "m", "△", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", "m", " ", " ", " ", " ", " ", " ", "*", "*", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", "△", " ", " ", " ", " ", " ", " ", " ", " ", "*", "*", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", "△", " ", " ", " ", "*", "*", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "*", "*", " ", " ", " ", " ", " ", " ", " ", " ", " ", "△", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "*", "*", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "*", "*", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        ["%", "%", " ", "%", " ", " ", "%", "%", "%", "%", " ", "*", "*", "%", "%", " ", "%", " ", "%", "%", " ", " ", "%", "%", " "],
        ["%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%", "%"],
      ],
      background: "&",
    },
    "Pyramid": {
      map: [
        ["|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|"],
        ["|", "↰", " ", " ", " ", "m", "|", " ", " ", "↰", " ", "m", "|", " ", " ", " ", " ", " ", "↰m", "|"],
        ["|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", "/", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", " ", "|"],
        ["|", "|", "|", "/", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "/", "|", "|", "|"],
        ["|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", " ", "|"],
        ["*", " ", " ", " ", " ", "m", "/", " ", " ", "↰", " ", "m", "/", " ", " ", " ", " ", " ", "↰m", "|"],
        ["|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", " ", "|"],
        ["|", "|", "|", "/", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|"],
        ["|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", "/", " ", " ", " ", " ", " ", "/", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", "|", " ", " ", " ", " ", " ", " ", "|"],
        ["|", "↰", " ", " ", " ", "m", "|", " ", " ", "↰", " ", "m", "|", " ", " ", " ", " ", " ", "↰m", "|"],
        ["|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|"],
      ],
      background: "&",
    },

    "Pyramid Upper": {
      map: [
        ["|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|"],
        ["|", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "↓", "|"],
        ["|", " ", "m", " ", " ", " ", " ", " ", " ", " ", "m", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", " ", "m", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "|"],
        ["↱", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", "m", " ", " ", " ", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", " ", " ", " ", "m", " ", " ", " ", " ", "|"],
        ["|", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "|"],
        ["|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|"],
      ],
      background: "&",
    },

    "Sea": {
      map: [
        ["k", " ", " ", " ", " ", " ", " ", " ", " ", "↉", "↉", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", "w", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "w", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", "w", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", "w", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "w", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", "w", " ", " ", "⌧", " ", "w", " ", " ", " ", " ", " ", " ", "w", " ", "w", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", "w", " ", " ", " ", " ", " ", " ", "w", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", "w", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "w", " "],
        [" ", " ", "w", " ", " ", " ", " ", " ", " ", "w", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", "w", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "w", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", "w", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", "w", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "w", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " "],
        [" ", " ", " ", " ", " ", " ", " ", " ", " ", " ", "♜", " ", " ", " ", " ", " ", " ", " ", " ", " "],
      ],
      background: "%",
    },

    "Home0 Floor0": {
      map: [
        ["⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰"],
        ["⦰", "s", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", "⦰", "⦰", "⦰", "⦰d", "⦰", "⦰", "⦰", "⦰", "⦰"],
      ],
      background: "G",
    },
    "Home0 Floor1": {
      map: [
        ["⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰"],
        ["⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰"],
        ["⦰", "⦰", "S", " ", " ", " ", " ", " ", "⦰", "⦰"],
        ["⦰", "⦰", " ", " ", " ", " ", " ", " ", "⦰", "⦰"],
        ["⦰", "⦰", " ", " ", " ", " ", " ", " ", "⦰", "⦰"],
        ["⦰", "⦰", " ", " ", " ", " ", " ", " ", "⦰", "⦰"],
        ["⦰", "⦰", "⦰", "⦰", "⦰⊞", "⦰⊞", "⦰", "⦰", "⦰", "⦰"],
        ["⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰"],
      ],
      background: "G",
    },
    "Home1 Floor0": {
      map: [
        ["⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", "t", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", "c", "⦰"],
        ["⦰d", " ", " ", " ", "⌧", "⌧", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", "⌧", "⌧", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰"],
      ],
      background: "G",
    },
    "Home2 Floor0": {
      map: [
        ["⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰"],
        ["⦰", "K", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰d"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰"],
      ],
      background: "G",
    },
    "Home3 Floor0": {
      map: [
        ["⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", "C", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰d", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰"],
      ],
      background: "G",
    },
    "Home4 Floor0": {
      map: [
        ["⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰"],
        ["⦰", "K", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰d"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", " ", " ", " ", " ", " ", " ", " ", " ", "⦰"],
        ["⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰", "⦰"],
      ],
      background: "G",
    },
  },
  // All the player's data resets
  player: {
    health: 10,
    maxhealth: 10,
    coins: 0,
    damage: 1,
    protection: 1,
    coinMultiplyer: 1,
    // You start at the same starting pos
    x: 5,
    y: 4,
    lastMove: [0, 1],
  },
  // The inventory resets
  inventory: {
    max: 10,
    at: 0,
    top: true,
    // All the items in the inventory disapears
    inventory: [],

    open: false,
    // All the itemse you have disapear
    equiped: {
      head: null,
      body: null,
      back: null,
      hands: null,
      feet: null,
    },
  },
  // The shop resets
  shop: {
    open: false,
    at: 0,

    // All the costs reset
    store: {
      max: {
        value: 5,
        multiplyer: 1.2,
        at: "inventory",
        increase: 1,
        display: {
          sprite: "0",
          text: [
            { text: "Upgrade the max\namount of items\nyou can carry", options: { x: 1, y: 5, color: color`2` } },
          ]
        }
      },
      damage: {
        value: 10,
        multiplyer: 1.15,
        at: "player",
        increase: 1,
        display: {
          sprite: "⚔",
          text: [
            { text: "Upgrade the amount\nof damage you can\ndo", options: { x: 1, y: 5, color: color`2` } },
          ]
        }
      },
      maxhealth: {
        value: 7.5,
        multiplyer: 1.1,
        at: "player",
        increase: 1,
        display: {
          sprite: "❣",
          text: [
            { text: "Upgrade the max\namount of health\nyou have", options: { x: 1, y: 5, color: color`2` } },
          ]
        }
      },
      protection: {
        value: 5,
        multiplyer: 1.25,
        at: "player",
        increase: 1,
        display: {
          sprite: " ",
          text: [
            { text: "Upgrade the amount\nof protection you\nhave", options: { x: 1, y: 5, color: color`2` } },
          ]
        }
      },
      coinMultiplyer: {
        value: 10,
        multiplyer: 1.25,
        at: "player",
        increase: 1,
        display: {
          sprite: "☘",
          text: [
            { text: "Upgrade the amount\nof coins you get", options: { x: 1, y: 5, color: color`2` } },
          ]
        }
      },
    },
  },
  enemy: {
    // The starting health reset
    startingHealth: 15,
    // The first names randomize
    firstNames: ["Darrin", "Alan", "Ned", "Shawn", "Ronnie", "Gerald", "Garth", "Jarvis", "Duncan", "Duane", "Elisha", "Andre", "Cedric", "Newton", "Jame", "Orval", "Burl", "Oren", "Dewey", "Sydney", "Britt", "Art", "Rafael", "Javier", "Toby", "Dirk", "Josh", "Dong", "Oliver", "Richie", "Noble", "Sammy", "Lance", "Jewel", "Jc", "Lino", "Russ", "Wyatt", "Gayle", "Abdul", "Elwood", "Joseph", "Joel", "Jerold", "Kyle", "Dana", "Tyrone", "Gerard", "Don", "Jorge", "Jeanette", "Gerald", "Roberto", "Gwen", "Richie", "Shelley", "Eugenio", "Alfreda", "Korey", "Irving", "Julianne", "Jennifer", "Cristopher", "Judy", "May", "Dewey", "Clayton", "Clara", "Nicole", "Alberta", "Rebekah", "Valentin", "Marcus", "Lazaro", "Gayle", "Carlene", "Elijah", "Consuelo", "Erna", "Murray", "Brenton", "Lenny", "Darren", "Dwayne", "Johnnie", "Donte", "Teresa", "Kristina", "Hoyt", "Randi", "Angelica", "Donna", "Julius", "Alfonso", "Alfredo", "Bennie", "Joni", "Angelique", "Joyce", "Marion"],
  },

  // The interactions reset because some deletes itself
  interactions: {
    "Default": {
      "0,0": (push) => {
        return ["Home0 Floor0", 4, 6, [0, -1]];
      },
      "13,4": (push) => {
        return ["Home1 Floor0", 1, 3, [1, 0]];
      },
      "10,6": (push) => {
        return ["Home2 Floor0", 8, 3, [-1, 0]];
      },
      "13,10": (push) => {
        return ["Home3 Floor0", 1, 3, [1, 0]];
      },
      "10,12": (push) => {
        return ["Home4 Floor0", 8, 3, [-1, 0]];
      },
      "25,1": (push) => {
        return ["Forest", 0, 1, [1, 0]];
      },
      "25,2": (push) => {
        return ["Forest", 0, 2, [1, 0]];
      },
      "11,20": (push) => {
        return ["Beach", 11, 0, [0, 1]];
      },
      "12,20": (push) => {
        return ["Beach", 12, 0, [0, 1]];
      },
    },

    "Forest": {
      "-1,1": (push) => {
        return ["Default", 24, 1, [-1, 0]];
      },
      "-1,2": (push) => {
        return ["Default", 24, 2, [-1, 0]];
      },
      "9,25": (push) => {
        return data.returnIfRandom("Forest Path", 5, 0, ["Forest Secret", 0, 1, [1, 0]]);
      },
      "13,-1": (push) => {
        return data.returnIfRandom("Forest Path", 5, 1, ["Forest Secret", 0, 1, [1, 0]]);
      },
      "24,-1": (push) => {
        return data.returnIfRandom("Forest Path", 5, 2, ["Forest Secret", 0, 1, [1, 0]]);
      },
      "25,0": (push) => {
        return data.returnIfRandom("Forest Path", 5, 2, ["Forest Secret", 0, 1, [1, 0]]);
      },
      "25,9": (push) => {
        return data.returnIfRandom("Forest Path", 5, 3, ["Forest Secret", 0, 1, [1, 0]]);
      },
      "19,25": (push) => {
        return data.returnIfRandom("Forest Path", 5, 4, ["Forest Secret", 0, 1, [1, 0]]);
      },
      "4,25": (push) => {
        return ["Forest Clearing", 9, 0, [0, 1]];
      },
      "5,25": (push) => {
        return ["Forest Clearing", 10, 0, [0, 1]];
      },
    },
    "Forest Secret": {
      "-1,1": (push) => {
        if (Math.floor(data.random["Forest Path"] * 5) == 0)
          return ["Forest", 9, 24, [0, -1]];
        else if (Math.floor(data.random["Forest Path"] * 5) == 1)
          return ["Forest", 13, 0, [0, 1]];
        else if (Math.floor(data.random["Forest Path"] * 5) == 2)
          return ["Forest", 24, 0, [0, 1]];
        else if (Math.floor(data.random["Forest Path"] * 5) == 3)
          return ["Forest", 24, 9, [-1, 0]];
        else
          return ["Forest", 19, 24, [0, -1]];
      },
      "8,11": (push) => {
        return ["Forest Secret Home", 1, 10, [1, 0]];
      },
    },
    "Forest Secret Home": {
      "0,10": (push) => {
        return ["Forest Secret", 7, 11, [-1, 0]];
      },
      "18,1": (push) => {
        if (!push) {
          data.text.input = false;
          data.text.text = "You look through the\ndesk you find a bag\nwith items inside.";
          data.text.options = {
            x: 0,
            color: color`2`
          }
          data.inventory.inventory.push("B");
          data.inventory.equip("B", "back");
          data.inventory.addItem("♥");
          data.inventory.addItem("k");
          data.inventory.addItem("h");
          data.inventory.addItem("↑");
          data.interactions[data.currentMap]["18,1"] = (push) => {
            if (!push) {
              data.text.input = false;
              data.text.text = "You look through the\ndesk you find\nnothing.";
              data.text.options = {
                x: 0,
                color: color`2`
              }
            }
            return [];
          }
        }
        return [];
      },
    },

    "Forest Clearing": {
      "9,-1": (push) => {
        return ["Forest", 4, 24, [0, -1]];
      },
      "10,-1": (push) => {
        return ["Forest", 5, 24, [0, -1]];
      },
      "1,1": (push) => {
        return ["Mine", 0, 0, [0, -1]];
      },
    },

    "Mine": {
      "0,-1": (push) => {
        return ["Forest Clearing", 1, 2, [0, 1]];
      },
      "9,9": (push) => {
        if (!push && data.inventory.removeItem("K")) {
          data.text.input = false;
          data.text.text = "You unlock and open the\nchest you find some\nitems inside.";
          data.text.options = {
            x: 0,
            color: color`2`
          }
          data.inventory.addItem("♥");
          data.inventory.addItem("#");
          data.inventory.addItem("k");
          data.maps[data.currentMap].map[9][9] = "♖";
          data.interactions[data.currentMap]["9,9"] = (push) => {
            if (!push) {
              if (!data.maps[data.currentMap].map[9][9].includes("⚪") && data.maps.Mine.map.every(row => row.every(tile => !tile.includes("M")))) {
                data.inventory.addItem("↔")
                data.text.input = false;
                data.text.text = "You look through the\nchest you find\na gem.";
                data.text.options = {
                  x: 0,
                  color: color`2`
                }
                data.addTypeAt(9, 9, "⚪")
                return [];
              }
              data.text.input = false;
              data.text.text = "You look through the\nchest you find\nnothing.";
              data.text.options = {
                x: 0,
                color: color`2`
              }
            }
            return [];
          }
        } else if (!push) {
          data.text.input = false;
          data.text.text = "The chest is locked.";
          data.text.options = {
            x: 0,
            color: color`2`
          }
        }
        return [];
      },
    },

    "Beach": {
      "11,-1": (push) => {
        return ["Default", 11, 19, [0, -1]];
      },
      "12,-1": (push) => {
        return ["Default", 12, 19, [0, -1]];
      },
      "4,4": (push) => {
        return data.returnIfRandom("Pyramid", 10, 0, ["Pyramid", 0, 10, [0, 1]]);
      },
      "8,2": (push) => {
        return data.returnIfRandom("Pyramid", 10, 1, ["Pyramid", 0, 10, [0, 1]]);
      },
      "15,3": (push) => {
        return data.returnIfRandom("Pyramid", 10, 2, ["Pyramid", 0, 10, [0, 1]]);
      },
      "20,5": (push) => {
        return data.returnIfRandom("Pyramid", 10, 3, ["Pyramid", 0, 10, [0, 1]]);
      },
      "22,7": (push) => {
        return data.returnIfRandom("Pyramid", 10, 4, ["Pyramid", 0, 10, [0, 1]]);
      },
      "18,11": (push) => {
        return data.returnIfRandom("Pyramid", 10, 5, ["Pyramid", 0, 10, [0, 1]]);
      },
      "22,15": (push) => {
        return data.returnIfRandom("Pyramid", 10, 6, ["Pyramid", 0, 10, [0, 1]]);
      },
      "7,14": (push) => {
        return data.returnIfRandom("Pyramid", 10, 7, ["Pyramid", 0, 10, [0, 1]]);
      },
      "2,13": (push) => {
        return data.returnIfRandom("Pyramid", 10, 8, ["Pyramid", 0, 10, [0, 1]]);
      },
      "6,9": (push) => {
        return data.returnIfRandom("Pyramid", 10, 9, ["Pyramid", 0, 10, [0, 1]]);
      },
      "11,20": (push) => {
        return ["Sea", 9, 0, [0, 1]];
      },
      "12,20": (push) => {
        return ["Sea", 10, 0, [0, 1]];
      },
    },
    "Pyramid": {
      "-1,10": (push) => {
        return data.returnIfRandomList("Pyramid", 10, ["Beach", 4, 5, [0, 1]],
          ["Beach", 8, 3, [0, 1]],
          ["Beach", 15, 4, [0, 1]],
          ["Beach", 20, 6, [0, 1]],
          ["Beach", 22, 8, [0, 1]],
          ["Beach", 18, 12, [0, 1]],
          ["Beach", 22, 16, [0, 1]],
          ["Beach", 7, 15, [0, 1]],
          ["Beach", 2, 14, [0, 1]],
          ["Beach", 6, 12, [0, 1]]);
      },
      "/": (posx, posy) => {
        if (data.inventory.removeItem("k")) {
          data.afterInputEval = `
          data.replaceTypeAt(${posx}, ${posy}, "/", "\\\\")`
        } else {
          data.text.input = false;
          data.text.text = "The door is locked.";
          data.text.options = {
            x: 0,
            color: color`L`
          }
        }
      },
      "1,0": (push) => {
        return data.returnIfRandom("Pyramid Stairs", 8, 0, ["Pyramid Upper", 0, 7, [1, 0]]);
      },
      "9,0": (push) => {
        return data.returnIfRandom("Pyramid Stairs", 8, 1, ["Pyramid Upper", 0, 7, [1, 0]]);
      },
      "18,0": (push) => {
        return data.returnIfRandom("Pyramid Stairs", 8, 2, ["Pyramid Upper", 0, 7, [1, 0]]);
      },
      "18,9": (push) => {
        if (data.player.y == 10)
          return data.returnIfRandom("Pyramid Stairs", 8, 3, ["Pyramid Upper", 0, 7, [1, 0]]);
        return [];
      },
      "18,17": (push) => {
        if (data.player.y == 18)
          return data.returnIfRandom("Pyramid Stairs", 8, 4, ["Pyramid Upper", 0, 7, [1, 0]]);
        return [];
      },
      "9,17": (push) => {
        if (data.player.y == 18)
          return data.returnIfRandom("Pyramid Stairs", 8, 5, ["Pyramid Upper", 0, 7, [1, 0]]);
        return [];
      },
      "1,17": (push) => {
        if (data.player.y == 18)
          return data.returnIfRandom("Pyramid Stairs", 8, 6, ["Pyramid Upper", 0, 7, [1, 0]]);
        return [];
      },
      "9,9": (push) => {
        if (data.player.y == 10)
          return data.returnIfRandom("Pyramid Stairs", 8, 7, ["Pyramid Upper", 0, 7, [1, 0]]);
        return [];
      },
    },
    "Pyramid Upper": {
      "0,6": (push) => {
        if (data.player.y == 7)
          return data.returnIfRandomList("Pyramid Stairs", 8, ["Pyramid", 1, 1, [0, -1]],
            ["Pyramid", 9, 1, [0, -1]],
            ["Pyramid", 18, 1, [0, -1]],
            ["Pyramid", 18, 10, [0, -1]],
            ["Pyramid", 18, 18, [0, -1]],
            ["Pyramid", 9, 18, [0, -1]],
            ["Pyramid", 1, 18, [0, -1]],
            ["Pyramid", 9, 10, [0, -1]]);
        return [];
      },
    },

    "Sea": {
      "9,-1": (push) => {
        return ["Beach", 11, 19, [0, -1]];
      },
      "10,-1": (push) => {
        return ["Beach", 12, 19, [0, -1]];
      },
      "10,19": (push) => {
        if (!push && data.inventory.removeItem("K")) {
          data.text.input = false;
          data.text.text = "You unlock and open the\nchest you find some\nitems inside.";
          data.text.options = {
            x: 0,
            color: color`2`
          }
          data.inventory.addItem("♥");
          data.inventory.addItem("k");
          data.inventory.addItem("!");
          data.maps[data.currentMap].map[19][10] = "♖";
          data.interactions[data.currentMap]["10,19"] = (push) => {
            if (!push) {
              data.text.input = false;
              data.text.text = "You look through the\nchest you find\nnothing.";
              data.text.options = {
                x: 0,
                color: color`2`
              }
            }
            return [];
          }
        } else if (!push) {
          data.text.input = false;
          data.text.text = "The chest is locked.";
          data.text.options = {
            x: 0,
            color: color`2`
          }
        }
        return [];
      },
    },

    "Home0 Floor0": {
      "4,7": (push) => {
        return ["Default", 0, 1, [0, 1]];
      },
      "1,0": (push) => {
        return ["Home0 Floor1", 2, 2, [0, 1]];
      },
      "8,1": (push) => {
        if (!push) {
          if (["←", "↑", "→", "↓", "↔"].some(item => data.inventory.inventory.includes(item))) {
            data.inventory.addItem("←", 8, 1);
            data.text.input = false;
            data.text.text = "You Got a Gem!";
            data.text.options = {
              x: 0,
              color: color`2`
            }
            delete data.interactions[data.currentMap]["8,1"];
          }
        }
        return [];
      },
    },
    "Home0 Floor1": {
      "2,1": (push) => {
        return ["Home0 Floor0", 1, 1, [0, 1]];
      },
      "⊞": (x, y) => {
        data.text.input = false;
        data.text.text = "You look out of the\nwindow";
        data.text.options = {
          x: 0,
          color: color`2`
        }
      },
      "⊠": (x, y) => {
        data.text.input = false;
        data.text.text = "You look out of the\nbroken window and\ncut yourself";
        data.text.options = {
          x: 0,
          color: color`2`
        }
        data.player.changeHealthta
      },
      "8,1": (push) => {},
    },
    "Home1 Floor0": {
      "0,3": (push) => {
        return ["Default", 12, 4, [-1, 0]];
      },
    },
    "Home2 Floor0": {
      "9,3": (push) => {
        return ["Default", 11, 6, [1, 0]];
      },
    },
    "Home3 Floor0": {
      "0,3": (push) => {
        return ["Default", 12, 10, [-1, 0]];
      },
      "8,1": (push) => {
        if (!push) {
          data.text.input = false;
          data.text.text = "Oh that is where I\nput my computer";
          data.text.options = {
            x: 0,
            color: color`2`
          }
          delete data.interactions[data.currentMap]["8,1"]
          data.afterInputEval = `data.removeTypeAt(8, 1, "C")`
          playTune(tune`
389.61038961038963: C4~389.61038961038963,
389.61038961038963: D4~389.61038961038963,
11688.311688311689`)
        }
        return [];
      },
    },
    "Home4 Floor0": {
      "9,3": (push) => {
        return ["Default", 11, 12, [1, 0]];
      },
    },
    "❶": (x, y) => {
      data.removeTypeAt(x, y, "❶");
      data.player.coins += 100;
    },
    "➋": (x, y) => {
      data.removeTypeAt(x, y, "➋");
      data.player.coins += 10;
    },
    "➌": (x, y) => {
      data.removeTypeAt(x, y, "➌");
      data.player.coins += 1;
    },
  },

  // The checks reset
  check: [
    (at) => {
      if (data.maps.Sea.map.every(row => row.every(tile => !tile.includes("w")))) {
        data.text.input = false;
        data.text.text = "You find a gem.";
        data.text.options = {
          x: 0,
          color: color`2`
        }
        data.inventory.addItem("→");
        delete data.check[at];
        return true;
      }
      return false;
    },
    (at) => {
      if (["←", "↑", "→", "↓", "↔"].every(item => data.inventory.inventory.includes(item))) {
        if (isInCurrentMap([
            ["", "⌧", "", "⌧", ""],
            ["", "", "", "", ""],
            ["⌧", "", "", "", "⌧"],
            ["", "⌧", "⌧", "⌧", ""],
          ], -2, -2)) {
          data.inventory.removeItems("←", "↑", "→", "↓", "↔");
          data.addTypeAt(data.player.x, data.player.y - 3, "℥");
          delete data.check[at]
        }
      }
    }
  ],

  // You start at the default map
  currentMap: "Default",
};

let data = {
  // What at the start of afterinput it gets evald then set to nothing
  afterInputEval: ``,
  // So each time you play the game it is a bit different
  random: {
    "Forest Path": Math.random(),
    "Pyramid": Math.random(),
    "Pyramid Stairs": Math.random(),
    "Menu Screen": Math.random(),
  },
  // Checks the random value and if it is it returns the location otherwise it returns a empty list
  returnIfRandom: (randomName, multiplyer, value, returnValue, returnValueFalse = []) => {
    if (Math.floor(data.random[randomName] * multiplyer) === value)
      return returnValue;
    return returnValueFalse;
  },
  // Checks the fandom value and returns the one that is correct
  returnIfRandomList: (randomName, multiplyer, ...returnValues) => {
    let value = 0;
    for (let returnValue of returnValues) {
      if (Math.floor(data.random[randomName] * multiplyer) === value)
        return returnValue;
      value++;
    }
    return []
  },
  // Ingame is just if they arn't on the title screen
  ingame: false,
  // The code that happens when you die
  die: () => {
    // No longer in game
    data.ingame = false;
    // The enemies data dissapears
    data.enemy.data = {};
    // Randomize all the random values
    for (let key of Object.keys(data.random)) {
      data.random[key] = Math.random();
    }
    // Stops the enemy from updating so no bugs happen
    clearInterval(data.enemy.interval);
  },
  // All the data of the player
  player: {
    // The health
    health: 10,
    // The max amound of health when you 
    maxhealth: 10,
    // The coins
    coins: 0,
    protection: 1,
    damage: 1,
    coinMultiplyer: 1,
    // The last move for holding direction
    lastMove: [0, 1],

    changehealth: (amount) => {
      if (amount < 0)
        data.player.health += amount / (data.player.protection + data.inventory.getBonus("protection", 1));
      else
        data.player.health += amount;
      if (data.player.health > data.player.maxhealth)
        data.player.health = data.player.maxhealth;
      else if (data.player.health <= 0 && !debug.OP)
        data.die();
    },

    x: 5,
    y: 4,
    move: (x, y) => {
      if (data.inventory.open) {
        data.inventory.at += x;
        if (!data.inventory.valid())
          data.inventory.at -= x;
        else
          playTune(tune`
500: C4/500,
15500`);
        if (data.inventory.top && y > 0) {
          data.inventory.top = false;
          if (!data.inventory.top && data.inventory.at >= Object.keys(data.inventory.equiped).length)
            data.inventory.at = Object.keys(data.inventory.equiped).length - 1;
        } else if (!data.inventory.top && y < 0)
          data.inventory.top = true;
      } else if (data.shop.open) {
        data.shop.at += x;
        if (data.shop.at >= Object.keys(data.shop.store).length || data.shop.at < 0)
          data.shop.at -= x;
        else
          playTune(tune`
500: C4/500,
15500`);
      } else {
        let pushed = false;
        if (data.isInBounds(data.player.x + x, data.player.y + y)) {
          if (data.ispush(data.player.x + x, data.player.y + y)) {
            if (data.push(data.player.x + x, data.player.y + y, [x, y])) {
              playTune(tune`
500: C4-500,
15500`);
              pushed = true;
            }
          }
          for (let type of data.maps[data.currentMap].map[data.player.y + y][data.player.x + x].split("")) {
            if (collectable.includes(type)) {
              if (!data.inventory.isFull()) {
                data.inventory.inventory.push(type);
                data.removeTypeAt(data.player.x + x, data.player.y + y, type);
                playTune(tune`
120: D4/120,
120: G4/120,
120: F4/120,
120: E4/120,
120: F4/120,
120: E4/120,
120: G4/120,
2880,
120: B4~120`)
              }
            }
          }
        }
        const interact = data.interact(data.player.x + x, data.player.y + y)
        if (!interact && (!data.colliding(data.player.x + x, data.player.y + y) || debug.OP && data.isInBounds(data.player.x + x, data.player.y + y))) {
          if (!pushed) {
            if (data.player.lastMove[0] === x && data.player.lastMove[1] === y)
              playTune(tune`
250: C4/250,
7750`);
            else
              playTune(tune`
500: C4/500,
15500`);
          }
          data.player.x += x;
          data.player.y += y;
        } else if (interact)
          playTune(tune`
500: C4/500 + D4-500,
15500`);
        data.player.lastMove = [x, y];
      }
    },
  },
  // All the data of enemies
  enemy: {
    data: {},
    startingHealth: 10,

    // Enemy health and coin multiplyer
    multiplyer: {
      "e": 1,
      "E": 2,
      "w": 2,
      "m": 2,
      "M": 2,
      "℥": 25,
    },

    // Functions to change / get things about the enemies
    changeEnemyHealth: (type, posx, posy, change, map = data.currentMap) => {
      if (!data.enemy.data[map])
        data.enemy.data[map] = {};
      if (!data.enemy.data[map][
          [posx, posy, type]
        ]) {
        data.enemy.data[map][
          [posx, posy, type]
        ] = { health: Math.round(data.enemy.startingHealth * data.enemy.multiplyer[type]), starting: Math.round(data.enemy.startingHealth * data.enemy.multiplyer[type]), name: data.enemy.getName() }
      }
      data.enemy.data[map][
        [posx, posy, type]
      ].health += change;
      if (data.enemy.data[map][
          [posx, posy, type]
        ].health <= 0) {
        data.removeTypeAt(posx, posy, type, map);
        const goldCoins = Math.floor(data.player.coinMultiplyer * data.enemy.multiplyer[type] / 100);
        const silverCoins = Math.floor((data.player.coinMultiplyer * data.enemy.multiplyer[type] - goldCoins * 100) / 10);
        const bronzeCoins = data.player.coinMultiplyer * data.enemy.multiplyer[type] - goldCoins * 100 - silverCoins * 10;
        for (let coin = 0; coin < goldCoins; coin++)
          data.addTypeAt(posx, posy, "❶", map);
        for (let coin = 0; coin < silverCoins; coin++)
          data.addTypeAt(posx, posy, "➋", map);
        for (let coin = 0; coin < bronzeCoins; coin++)
          data.addTypeAt(posx, posy, "➌", map);
        delete data.enemy.data[map][
          [posx, posy, type]
        ];
      }
    },
    getEnemyHealth: (type, posx, posy) => {
      if (!data.enemy.data[data.currentMap])
        data.enemy.data[data.currentMap] = {};
      if (!data.enemy.data[data.currentMap][
          [posx, posy, type]
        ]) {
        data.enemy.data[data.currentMap][
          [posx, posy, type]
        ] = { health: Math.round(data.enemy.startingHealth * data.enemy.multiplyer[type]), starting: Math.round(data.enemy.startingHealth * data.enemy.multiplyer[type]), name: data.enemy.getName() }
      }
      return Math.ceil(data.enemy.data[data.currentMap][
        [posx, posy, type]
      ].health / data.enemy.data[data.currentMap][
        [posx, posy, type]
      ].starting * 10);
    },
    getEnemyData: (posx, posy, map = data.currentMap) => {
      let type = "";
      for (let t of data.enemy.types) {
        if (data.isTypeAt(posx, posy, t, map))
          type = t;
      }
      if (type) {
        if (!data.enemy.data[map])
          data.enemy.data[map] = {};
        if (!data.enemy.data[map][
            [posx, posy, type]
          ]) {
          data.enemy.data[map][
            [posx, posy, type]
          ] = { health: Math.round(data.enemy.startingHealth * data.enemy.multiplyer[type]), starting: Math.round(data.enemy.startingHealth * data.enemy.multiplyer[type]), name: data.enemy.getName() }
        }
        return data.enemy.data[map][
          [posx, posy, type]
        ];
      }
      return false;
    },
    setEnemyPos: (type, posx, posy, newx, newy, newmap = data.currentMap) => {
      if (!data.enemy.data[data.currentMap])
        data.enemy.data[data.currentMap] = {};
      if (!data.enemy.data[data.currentMap][
          [posx, posy, type]
        ]) {
        data.enemy.data[data.currentMap][
          [posx, posy, type]
        ] = { health: Math.round(data.enemy.startingHealth * data.enemy.multiplyer[type]), starting: Math.round(data.enemy.startingHealth * data.enemy.multiplyer[type]), name: data.enemy.getName() }
        
      }
      if (!data.enemy.data[newmap])
        data.enemy.data[newmap] = {};
      const temp = structuredClone(data.enemy.data[data.currentMap][
        [posx, posy, type]
      ]);
      delete data.enemy.data[data.currentMap][
        [posx, posy, type]
      ];
      data.enemy.data[newmap][
        [newx, newy, type]
      ] = temp;
    },
    getName: () => {
      let name = data.enemy.firstNames[0];
      data.enemy.firstNames.splice(0, 1);
      data.enemy.firstNames.push(name);
      return name;
    },
    
    // All the enemy types
    types: ["e", "E", "m", "w", "M", "℥"],
    // It moves all the enemies
    update: () => {
      let moved = false;
      for (let type of data.enemy.types) {
        for (let pos of data.enemy.getAll(type)) {
          let movex = Math.abs(data.player.x - pos[0]) / (data.player.x - pos[0]);
          let movey = Math.abs(data.player.y - pos[1]) / (data.player.y - pos[1]);
          let move = [Math.abs(data.player.x - pos[0]) / (data.player.x - pos[0]), Math.abs(data.player.y - pos[1]) / (data.player.y - pos[1])];
          let random = Math.random();
          if (!movex || Math.abs(data.player.x - pos[0]) < Math.abs(data.player.y - pos[1]) || Math.abs(data.player.x - pos[0]) == Math.abs(data.player.y - pos[1]) && random < 0.5)
            movex = 0;
          if (!movey || Math.abs(data.player.x - pos[0]) > Math.abs(data.player.y - pos[1]) || Math.abs(data.player.x - pos[0]) == Math.abs(data.player.y - pos[1]) && random >= 0.5)
            movey = 0;
          if (movex + pos[0] == data.player.x && movey + pos[1] == data.player.y)
            data.player.changehealth(-1);
          else if (data.enemy.move(pos[0], pos[1], movex, movey, type) || data.enemy.move(pos[0], pos[1], move[0] - movex, move[1] - movey, type))
            moved = true;
        }
      }
      if (moved)
        playTune(tune`
500: C4^500 + D4~500,
15500`);
      data.update();
    },
    // The interval so I can stop it
    interval: -1,

    // Function get all of a type of enemy
    getAll: (type = "e") => {
      let enemies = [];
      for (let y = 0; y < data.maps[data.currentMap].map.length; y++) {
        for (let x = 0; x < data.maps[data.currentMap].map[y].length; x++) {
          if (data.maps[data.currentMap].map[y][x].split("").includes(type)) {
            enemies.push([x, y]);
          }
        }
      }
      return enemies;
    },

    // Move a certain enemy
    move: (x, y, movex, movey, type = "e") => {
      x += movex;
      y += movey;
      let [newmap, newx, newy, newdir] = data.interact(x, y, data.currentMap, true);
      if (typeof newmap === 'undefined')
        newmap = data.currentMap;
      if (typeof newx === 'undefined')
        newx = x;
      if (typeof newy === 'undefined')
        newy = y;
      if (typeof newdir === 'undefined')
        newdir = [movex, movey];
      if (data.isInBounds(newx, newy, newmap)) {
        if (data.ispush(newx, newy, newmap)) {
          if (data.push(newx, newy, newdir, newmap)) {}
        }
      }
      if (!data.colliding(newx, newy, newmap)) {
        data.addTypeAt(newx, newy, type, newmap);
        data.removeTypeAt(x - movex, y - movey, type)
        data.enemy.setEnemyPos(type, x - movex, y - movey, newx, newy, newmap)
        return true;
      }
      return false;
    },
  },
  // The inventory
  inventory: {
    // All the items
    inventory: [],
    // The amount of inventory slots
    max: 10,
    at: 0,
    top: true,
    // Functions to add items/remove items
    addItem: (item, x = data.player.x, y = data.player.y, map = data.currentMap) => {
      if (!data.inventory.isFull()) {
        data.inventory.inventory.push(item);
        return true;
      }
      data.addTypeAt(x, y, item, map);
      return false;
    },
    removeItem: (item) => {
      let index = data.inventory.inventory.indexOf(item);
      if (index != -1) {
        data.inventory.inventory.splice(index, 1);
        return true;
      }
      return false;
    },
    removeItems: (...items) => {
      for (let item of items)
        data.inventory.removeItem(item);
    },

    // This is how you drop
    drop: () => {
      let item = data.inventory.inventory[data.inventory.at];
      if (item) {
        let x = data.player.x + data.player.lastMove[0];
        let y = data.player.y + data.player.lastMove[1];
        if (!data.isInBounds(x, y)) {
          x = data.player.x;
          y = data.player.y;
        }
        data.addTypeAt(x, y, item);
        data.inventory.inventory.splice(data.inventory.at, 1);
      }
    },

    open: false,

    // All the inventory data witch is just a list of {text, options}
    data: {
      "C": [{ text: "My Computer", options: { y: 5, color: color`2` } }, { text: "How do you have my\ncomputer?", options: { x: 1, y: 6, color: color`1` } }],
      "g": [{ text: "Grass", options: { y: 5, color: color`2` } }, { text: "Why and how you\nhave grass?", options: { x: 1, y: 6, color: color`1` } }],
      "⦰": [{ text: "Void", options: { y: 5, color: color`2` } }, { text: "How do you even\nhave void, void is\nnothing?", options: { x: 1, y: 6, color: color`1` } }],
      "⌂": [{ text: "House", options: { y: 5, color: color`2` } }, { text: "What you're\ncarrying a house\nnow?", options: { x: 1, y: 6, color: color`1` } }],
      "⊟": [{ text: "House Rotated", options: { y: 5, color: color`2` } }, { text: "What you're\ncarrying a house\nnow?", options: { x: 1, y: 6, color: color`1` } }],
      "c": [{ text: "Chair", options: { y: 5, color: color`2` } }, { text: "Is it a nice chair?", options: { x: 1, y: 6, color: color`1` } }],
      "t": [{ text: "Table", options: { y: 5, color: color`2` } }, { text: "Why do you also\nhave a table?", options: { x: 1, y: 6, color: color`1` } }],
      "⊞": [{ text: "Window", options: { y: 5, color: color`2` } }, { text: "Watch out it is\nfragile, how is it\nnot broken?", options: { x: 1, y: 6, color: color`1` } }],
      "⊠": [{ text: "Broken Window", options: { y: 5, color: color`2` } }, { text: "How are you not cut?", options: { x: 1, y: 6, color: color`1` } }],
      "⌧": [{ text: "Box", options: { y: 5, color: color`2` } }, { text: "Can't you only\npush them?", options: { x: 1, y: 6, color: color`1` } }],
      "d": [{ text: "Door", options: { y: 5, color: color`2` } }, { text: "What are you going\nto do leave the\ninventory?", options: { x: 1, y: 6, color: color`1` } }],
      "h": [{ text: "Hat", options: { y: 5, color: color`2` } }, { text: "Do you like the\nhat I made?", options: { x: 1, y: 6, color: color`1` } }],
      "B": [{ text: "Bag", options: { y: 5, color: color`2` } }, { text: "Do you like the\nbag I made?", options: { x: 1, y: 6, color: color`1` } }],
      "◻": [{ text: "Inventory Slot", options: { y: 5, color: color`2` } }, { text: "How do you even\nhave a inventory\nslot in your\ninventory?", options: { x: 1, y: 6, color: color`1` } }],
      "♥": [{ text: "Health Potion", options: { y: 5, color: color`2` } }, { text: "Is that a health\npotion that heals\nyou?", options: { x: 1, y: 6, color: color`1` } }],
      "k": [{ text: "Gold Key", options: { y: 5, color: color`2` } }, { text: "Is that a gold key\nthat opens doors?", options: { x: 1, y: 6, color: color`1` } }],
      "K": [{ text: "Silver Key", options: { y: 5, color: color`2` } }, { text: "Is that a silver\nkey that opens\ndoors?", options: { x: 1, y: 6, color: color`1` } }],
      "Ⅎ": [{ text: "Bronze Key", options: { y: 5, color: color`2` } }, { text: "Is that a bronze\nkey that opens\ndoors?", options: { x: 1, y: 6, color: color`1` } }],
      "!": [{ text: "Sword", options: { y: 5, color: color`2` } }, { text: "Why do you need a\nsword when you\nhave your fist's?", options: { x: 1, y: 6, color: color`1` } }],
      "#": [{ text: "Sheild", options: { y: 5, color: color`2` } }, { text: "Why do you need a\nsheild when you\nhave your head?", options: { x: 1, y: 6, color: color`1` } }],
      "←": [{ text: "Gem", options: { y: 5, color: color`2` } }, { text: "Why do you need a\ngem when it has no\nuse?", options: { x: 1, y: 6, color: color`1` } }],
      "↑": [{ text: "Gem grass", options: { y: 5, color: color`2` } }, { text: "Why do you need a\ngrass gem when it\nhas no use?", options: { x: 1, y: 6, color: color`1` } }],
      "→": [{ text: "Gem water", options: { y: 5, color: color`2` } }, { text: "Why do you need a\nwater gem when it\nhas no use?", options: { x: 1, y: 6, color: color`1` } }],
      "↓": [{ text: "Gem sand", options: { y: 5, color: color`2` } }, { text: "Why do you need a\nsand gem when it\nhas no use?", options: { x: 1, y: 6, color: color`1` } }],
      "↔": [{ text: "Gem mine", options: { y: 5, color: color`2` } }, { text: "Why do you need a\nmine gem when it\nhas no use?", options: { x: 1, y: 6, color: color`1` } }],
      "\"": [{ text: "Select left", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe main menu\nselect left?", options: { x: 1, y: 6, color: color`1` } }],
      "O": [{ text: "Select middle", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe main menu\nselect middle?", options: { x: 1, y: 6, color: color`1` } }],
      "'": [{ text: "Select right", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe main menu\nselect right?", options: { x: 1, y: 6, color: color`1` } }],
      "q": [{ text: "Button left", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe main menu\nbutton left?", options: { x: 1, y: 6, color: color`1` } }],
      "o": [{ text: "Button middle", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe main menu\nbutton middle?", options: { x: 1, y: 6, color: color`1` } }],
      "Q": [{ text: "Button right", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe main menu\nbutton right?", options: { x: 1, y: 6, color: color`1` } }],
      "◼": [{ text: "Slot selection", options: { y: 5, color: color`2` } }, { text: "How do you even\nhave the inventory\nslot selection?", options: { x: 1, y: 6, color: color`1` } }],
      "b": [{ text: "Bag display", options: { y: 5, color: color`2` } }, { text: "How do you even\nget the bag\ndisplay?", options: { x: 1, y: 6, color: color`1` } }],
      "⌖": [{ text: "Hand", options: { y: 5, color: color`2` } }, { text: "How do you even\nhave your hand in\nyour inventory?", options: { x: 1, y: 6, color: color`1` } }],
      "♜": [{ text: "Chest", options: { y: 5, color: color`2` } }, { text: "How does the chest\nfit in your\ninventory?", options: { x: 1, y: 6, color: color`1` } }],
      "♖": [{ text: "Chest Open", options: { y: 5, color: color`2` } }, { text: "How does the chest\nthat is open fit\nin your inventory?", options: { x: 1, y: 6, color: color`1` } }],
      "☘": [{ text: "Luck", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe luck symbol?", options: { x: 1, y: 6, color: color`1` } }],
      "⚔": [{ text: "Damage", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe Damage symbol?", options: { x: 1, y: 6, color: color`1` } }],
      "0": [{ text: "Inventory slots", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe Inventory slot\nsymbol?", options: { x: 1, y: 6, color: color`1` } }],
      "❣": [{ text: "Max health", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe max health\nsymbol?", options: { x: 1, y: 6, color: color`1` } }],
      " ": [{ text: "Protection", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe Protection symbol?", options: { x: 1, y: 6, color: color`1` } }],
      "1": [{ text: "Health 10%", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe display for\n10% health?", options: { x: 1, y: 6, color: color`1` } }],
      "2": [{ text: "Health 20%", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe display for\n20% health?", options: { x: 1, y: 6, color: color`1` } }],
      "3": [{ text: "Health 30%", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe display for\n30% health?", options: { x: 1, y: 6, color: color`1` } }],
      "4": [{ text: "Health 40%", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe display for\n40% health?", options: { x: 1, y: 6, color: color`1` } }],
      "5": [{ text: "Health 50%", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe display for\n50% health?", options: { x: 1, y: 6, color: color`1` } }],
      "6": [{ text: "Health 60%", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe display for\n60% health?", options: { x: 1, y: 6, color: color`1` } }],
      "7": [{ text: "Health 70%", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe display for\n70% health?", options: { x: 1, y: 6, color: color`1` } }],
      "8": [{ text: "Health 80%", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe display for\n80% health?", options: { x: 1, y: 6, color: color`1` } }],
      "9": [{ text: "Health 90%", options: { y: 5, color: color`2` } }, { text: "How do you have\nthe display for\n90% health?", options: { x: 1, y: 6, color: color`1` } }],
      "☺": [{ text: "Player", options: { y: 5, color: color`2` } }, { text: "How are you\nliterally in your\ninventory?", options: { x: 1, y: 6, color: color`1` } }],
      "e": [{ text: "Enemy", options: { y: 5, color: color`2` } }, { text: "How do you have\na enemy in\nyour inventory?", options: { x: 1, y: 6, color: color`1` } }],
      "E": [{ text: "Enemy grass", options: { y: 5, color: color`2` } }, { text: "How do you have\na enemy grass in\nyour inventory?", options: { x: 1, y: 6, color: color`1` } }],
      "w": [{ text: "Enemy water", options: { y: 5, color: color`2` } }, { text: "How do you have\na enemy water in\nyour inventory?", options: { x: 1, y: 6, color: color`1` } }],
      "m": [{ text: "Enemy sand", options: { y: 5, color: color`2` } }, { text: "How do you have\na enemy sand in\nyour inventory?", options: { x: 1, y: 6, color: color`1` } }],
      "M": [{ text: "Enemy mine", options: { y: 5, color: color`2` } }, { text: "How do you have\na enemy mine in\nyour inventory?", options: { x: 1, y: 6, color: color`1` } }],
      "℥": [{ text: "Enemy boss", options: { y: 5, color: color`2` } }, { text: "How do you have\na enemy boss in\nyour inventory?", options: { x: 1, y: 6, color: color`1` } }],
      "❶": [{ text: "Gold Coin", options: { y: 5, color: color`2` } }, { text: "How do you even\nhave a Gold Coin\nin your inventory?", options: { x: 1, y: 6, color: color`1` } }],
      "➋": [{ text: "Silver Coin", options: { y: 5, color: color`2` } }, { text: "How do you even\nhave a Silver Coin\nin your inventory?", options: { x: 1, y: 6, color: color`1` } }],
      "➌": [{ text: "Bronze Coin", options: { y: 5, color: color`2` } }, { text: "How do you even\nhave a Bronze Coin\nin your inventory?", options: { x: 1, y: 6, color: color`1` } }],
      "⌬": [{ text: "Broken Box", options: { y: 5, color: color`2` } }, { text: "How do you even\nget all the pieces\nto stay?", options: { x: 1, y: 6, color: color`1` } }],
      "△": [{ text: "Pyramid", options: { y: 5, color: color`2` } }, { text: "How do you even\ncarry a full\npyramid?", options: { x: 1, y: 6, color: color`1` } }],
      "@": [{ text: "Mine", options: { y: 5, color: color`2` } }, { text: "How is it\nphysically possible\nto carry a mine?", options: { x: 1, y: 6, color: color`1` } }],
      "T": [{ text: "Tree", options: { y: 5, color: color`2` } }, { text: "How did you pick\nup that tree?", options: { x: 1, y: 6, color: color`1` } }],
      "s": [{ text: "Stairs up", options: { y: 5, color: color`2` } }, { text: "How do you even\ncarry stairs?", options: { x: 1, y: 6, color: color`1` } }],
      "S": [{ text: "Stairs down", options: { y: 5, color: color`2` } }, { text: "How do you even\ncarry stairs?", options: { x: 1, y: 6, color: color`1` } }],
      "↰": [{ text: "Sand Stairs up", options: { y: 5, color: color`2` } }, { text: "How do you even\ncarry stairs?", options: { x: 1, y: 6, color: color`1` } }],
      "↱": [{ text: "Sand Stairs down", options: { y: 5, color: color`2` } }, { text: "How do you even\ncarry stairs?", options: { x: 1, y: 6, color: color`1` } }],
      "|": [{ text: "Sand wall", options: { y: 5, color: color`2` } }, { text: "How do you even\nhave a wall?", options: { x: 1, y: 6, color: color`1` } }],
      "/": [{ text: "Sand door", options: { y: 5, color: color`2` } }, { text: "How do you even\nhave a door?", options: { x: 1, y: 6, color: color`1` } }],
      "\\": [{ text: "Sand door open", options: { y: 5, color: color`2` } }, { text: "How do you even\nhave a open door?", options: { x: 1, y: 6, color: color`1` } }],
      "P": [{ text: "Path", options: { y: 5, color: color`2` } }, { text: "How are you\ncarrying a path?", options: { x: 1, y: 6, color: color`1` } }],
      "G": [{ text: "Ground", options: { y: 5, color: color`2` } }, { text: "How do you\nhave the wooden\nground?", options: { x: 1, y: 6, color: color`1` } }],
      "%": [{ text: "Water", options: { y: 5, color: color`2` } }, { text: "How do you\nhave the water and\nis it wet?", options: { x: 1, y: 6, color: color`1` } }],
      "↉": [{ text: "Sand bits", options: { y: 5, color: color`2` } }, { text: "How do you\nhave small bits of\nsand?", options: { x: 1, y: 6, color: color`1` } }],
      "*": [{ text: "Sand Path", options: { y: 5, color: color`2` } }, { text: "How do you\nhave a sand\npath?", options: { x: 1, y: 6, color: color`1` } }],
      "&": [{ text: "Sand", options: { y: 5, color: color`2` } }, { text: "How do you\nhave a lot of\nsand?", options: { x: 1, y: 6, color: color`1` } }],
      "⚪": [{ text: "Rock", options: { y: 5, color: color`2` } }, { text: "How are you\ncarrying a lot\nof rocks?", options: { x: 1, y: 6, color: color`1` } }],
    },

    // All the functions when items are used
    usable: {
      "h": () => {
        return data.inventory.equip("h", "head");
      },
      "B": () => {
        return data.inventory.equip("B", "back");
      },
      "◻": () => {
        data.inventory.max += 1;
        data.inventory.inventory.splice(data.inventory.at, 1);
        return true;
      },
      "⦰": () => {
        data.inventory.max -= 1;
        data.inventory.inventory.splice(data.inventory.at, 1);
        return true;
      },
      "⊞": () => {
        data.inventory.inventory[data.inventory.at] = "⊠";
        return true;
      },
      "♥": () => {
        data.player.changehealth(Math.round(data.player.maxhealth / 4));
        data.inventory.inventory.splice(data.inventory.at, 1);
        return true;
      },
      "!": () => {
        return data.inventory.equip("!", "hands");
      },
      "#": () => {
        return data.inventory.equip("#", "hands");
      },
    },
    // The function to use / unequip items
    use: () => {
      if (data.inventory.top) {
        if (data.inventory.usable[data.inventory.inventory[data.inventory.at]])
          return data.inventory.usable[data.inventory.inventory[data.inventory.at]]();
      } else
        return data.inventory.equip(null, Object.keys(data.inventory.equiped)[data.inventory.at])
    },

    // Bonuses when a item is equiped
    equipBonus: {
      "B": {
        max: 3,
      },
      "!": {
        damage: 2,
      },
      "#": {
        protection: 2,
      },
    },
    getBonus: (bonus, startValue = 0) => {
      let bonusValue = startValue
      for (let item of Object.values(data.inventory.equiped)) {
        if (data.inventory.equipBonus[item]) {
          bonusValue += data.inventory.equipBonus[item][bonus] || 0;
        }
      }
      return bonusValue
    },

    // All the equipped items
    equiped: {
      head: null,
      body: null,
      back: null,
      hands: null,
      feet: null,
    },
    // The function to equip items
    equip: (item, slot) => {
      const oldItem = data.inventory.equiped[slot];
      if (oldItem)
        data.inventory.inventory.push(oldItem);
      data.inventory.equiped[slot] = item;
      if (data.inventory.inventory.indexOf(item) != -1)
        data.inventory.inventory.splice(data.inventory.inventory.indexOf(item), 1);
      if (data.inventory.isSuperFull()) {
        data.inventory.inventory.push(item);
        data.inventory.equiped[slot] = oldItem;
        data.inventory.inventory.splice(data.inventory.inventory.indexOf(oldItem), 1);
        return false;
      }
      return true;
    },

    // Checks if where you are at is valid
    valid: () => {
      if (!data.inventory.top && data.inventory.at >= Object.keys(data.inventory.equiped).length)
        return false;
      if (data.inventory.at < 0)
        return false;
      if (data.inventory.at + 1 > data.inventory.max + data.inventory.getBonus("max"))
        return false;
      return true;
    },
    // Functions to check if the inventory is full/overflowing
    isFull: () => {
      return data.inventory.inventory.length > data.inventory.max + data.inventory.getBonus("max") - 1;
    },
    isSuperFull: () => {
      return data.inventory.inventory.length > data.inventory.max + data.inventory.getBonus("max");
    },
  },
  // Menu data
  menu: {
    credits: {
      text: ['This game is made by: Me_Myself_and_I it could not be made without these people', 'Most contributed: Me_Myself_and_I', 'Game design: Me_Myself_and_I', 'Game concept: Me_Myself_and_I', 'Art: Me_Myself_and_I', 'Making the home screen: Me_Myself_and_I', 'Programming: Me_Myself_and_I', 'Music: Me_Myself_and_I', 'Sound Effects: Me_Myself_and_I', 'Finding bugs: Me_Myself_and_I', 'Fixing bugs: Me_Myself_and_I', 'Making the credits: Me_Myself_and_I', 'Made in: sprig', 'Invented html: Tim Berners-Lee', 'Invented css: Håkon Wium Lie', 'Invented js: Brendan Eich', 'Who made sprig: hackclub', 'Where I got most of the bitmap character names from: https://copypastecharacter.com/all-characters', 'Where I got most of the enemy names from: https://randomwordgenerator.com/name.php', 'Playing this game I made for fun: You the player', 'Thank you for checking out my game', 'P.S. Have you found some easter eggs?'],
      open: false,
      at: [0, 0],
      move: (x, y) => {
        data.menu.credits.at[0] += x;
        data.menu.credits.at[1] += y;
        if (data.menu.credits.at[0] < 0)
          data.menu.credits.at[0] = 0;
        if (data.menu.credits.at[1] < 0)
          data.menu.credits.at[1] = 0;
        if (data.menu.credits.at[1] > data.menu.credits.text.length - 16)
          data.menu.credits.at[1] = data.menu.credits.text.length - 16;
        if (data.menu.credits.at[0] > Math.max(...data.menu.credits.text.map(el => el.length)) - 20)
          data.menu.credits.at[0] = Math.max(...data.menu.credits.text.map(el => el.length)) - 20;
      }
    },
    // This is just so it shows the screen htat says what the buttons do
    howToPlay: true,
    y: 0,
    // All the screens that is in the main menu
    screens: [
      { map: map`
⌂........T
.☺PPPPPPPP
.PPPPPPPPP
....PP....
...⊟PP.e.T
....PP...T
.e..PP⊟...
&&.&PP&&..`, bg: "g" },
      { map: map`
s.........
☺....M....
..........
....M.....
..........
.......M..
.M........
.........M`, bg: "⚪" },
      { map: map`
....PP....
...☺**..m.
....**.△..
..△.**....
m...**..△.
....**....
△...**...m
....**...△`, bg: "&" },
      { map: map`
....↉↉....
..........
..w.....w.
..........
..........
.......w..
.w........
..........`, bg: "%" },
      { map: map`
⦰⦰⦰⦰⦰⦰⦰⦰⦰⦰
⦰se......⦰
⦰........⦰
⦰.☺...e..⦰
⦰........⦰
⦰........⦰
⦰..e.....⦰
⦰⦰⦰⦰⦰⦰⦰⦰⦰⦰`, bg: "G" },
      { map: map`
TTTTTTTTTT
....T.TT.T
☺....TTTTT
TTT.ET.TT.
.TT..TTT.T
TTTE.T.TTT
T.T..TTT.T
.TT..T.TTT`, bg: "g" },
    ],

    // This just moves the selection up and down
    move: (x, y) => {
      data.menu.y += y;
      if (data.menu.y < 0)
        data.menu.y = 0;
      else if (data.menu.y >= Object.values(data.menu.buttons).length)
        data.menu.y = Object.values(data.menu.buttons).length - 1;
    },

    // The buttons
    buttons: {
      "Play Game": () => {
        data.menu.restart();
      },
      "Credits": () => {
        data.menu.credits.open = true;
      },
      "Rage Quit": () => {
        clearInterval(data.enemy.interval);
        [start, data] = [];
        setMap(map`
⦰`);
      },
    },

    select: () => {
      Object.values(data.menu.buttons)[data.menu.y]();
    },

    restart: () => {
      data = merge(data, start);
      data.update();
      data.enemy.interval = setInterval(data.enemy.update, 1000);
    },
  },
  // Shop data
  shop: {
    open: false,
    at: 0,
    store: {},
    buy: () => {
      const bonus = Object.keys(data.shop.store)[data.shop.at];
      if (data.shop.store[bonus]) {
        if (data.player.coins >= Math.ceil(data.shop.store[bonus].value) || debug.OP) {
          data.player.coins -= Math.ceil(data.shop.store[bonus].value);
          if (data.shop.store[bonus].at)
            data[data.shop.store[bonus].at][bonus] += data.shop.store[bonus].increase || 1;
          else
            data[bonus] += data.shop.store[bonus].increase || 1;
          if (bonus == "maxhealth")
            data.player.health += data.shop.store[bonus].increase || 1;
          data.enemy.startingHealth += 0.1;
          data.shop.store[bonus].value *= data.shop.store[bonus].multiplyer;
          return true;
        }
      }
      return false;
    },
    // Gets the current value
    get: () => {
      let value;
      if (Object.values(data.shop.store)[data.shop.at].at)
        value = data[Object.values(data.shop.store)[data.shop.at].at][Object.keys(data.shop.store)[data.shop.at]];
      else
        value = data[Object.keys(data.shop.store)[data.shop.at]];
      return data.shop.convert[Object.keys(data.shop.store)[data.shop.at]](value);
    },
    // All the functions to convert the number to the value
    convert: {
      max: (value) => { return value + " slots" },
      damage: (value) => { return value + " DMG" },
      maxhealth: (value) => { return value + " HP" },
      protection: (value) => { return value + " DEF" },
      coinMultiplyer: (value) => { return value + " luck" },
    },
    // The function to get the price of the current selected
    getPrice: () => {
      return Math.floor(Object.values(data.shop.store)[data.shop.at].value) + "C";
    },
  },

  check: [],
  // The current map that you are in
  currentMap: "Default",
  maps: {},
  // functions to remove / replace / add / check if a type is at
  removeTypeAt: (x, y, type, map = data.currentMap) => {
    if (data.isInBounds(x, y, map))
      data.maps[map].map[y][x] = data.maps[map].map[y][x].replace(type, "");
  },
  replaceTypeAt: (x, y, type, newType, map = data.currentMap) => {
    if (data.isTypeAt(x, y, type, map)) {
      data.removeTypeAt(x, y, type, map);
      data.addTypeAt(x, y, newType, map);
    }
  },
  addTypeAt: (x, y, type, map = data.currentMap) => {
    if (data.isInBounds(x, y, map))
      data.maps[map].map[y][x] += type;
  },
  isTypeAt: (x, y, type, map = data.currentMap) => {
    if (data.isInBounds(x, y, map))
      return data.maps[map].map[y][x].includes(type);
    return false;
  },

  // This is how I display text
  text: {
    input: true,
    // The text to display
    text: "",
    // The text options
    options: {},
  },

  interactions: {},
  // The function to interact / go into/out of a place
  interact: (posx = data.player.x, posy = data.player.y, map = data.currentMap, push = false, oldx, oldy) => {
    if (!push) {
      if (data.isInBounds(posx, posy, map)) {
        for (let type of data.maps[map].map[posy][posx].split("")) {
          if (type && type != " ") {
            if (data.interactions[map][type])
              data.interactions[map][type](posx, posy);
            if (data.interactions[type])
              data.interactions[type](posx, posy);
          }
        }
      }
    }
    if (data.interactions[map][
        [posx, posy]
      ]) {
      let [currentMap, x, y, dir] = data.interactions[map][
        [posx, posy]
      ](push, oldx, oldy);
      if (push)
        return [currentMap, x, y, dir];
      if (typeof dir !== 'undefined') {
        if (data.ispush(x, y, currentMap)) {
          data.push(x, y, dir, currentMap);
        }
      }
      if (!data.colliding(x, y, currentMap)) {
        data.currentMap = currentMap;
        data.player.x = x;
        data.player.y = y;
        data.interact();
        return true;
      } else if (data.isInBounds(x, y, currentMap)) {
        data.text.input = false;
        data.text.text = "The enterance is\nblocked try\nattacking.";
        data.text.options = {
          x: 0,
          y: 0,
          color: color`2`
        }
      }
    } else if (push)
      return [undefined, undefined, undefined, undefined];
    else
      return false;
  },

  // Functions to check if a spot has a pushable
  ispush: (x, y, map = data.currentMap) => {
    if (!data.isInBounds(x, y, map))
      return false;
    return data.maps[map].map[y][x].split("").some(item => pushable.includes(item));
  },
  // The function to push
  push: (x, y, dir, map = data.currentMap) => {
    let [newmap, newx, newy, newdir] = data.interact(x + dir[0], y + dir[1], map, true);
    if (typeof newmap === 'undefined')
      newmap = map;
    if (typeof newx === 'undefined')
      newx = x + dir[0];
    if (typeof newy === 'undefined')
      newy = y + dir[1];
    if (typeof newdir === 'undefined')
      newdir = dir;
    if (data.ispush(newx, newy, newmap)) {
      data.push(newx, newy, newdir, newmap)
    }
    if (data.colliding(newx, newy, newmap))
      return false;
    for (let type of data.maps[map].map[y][x].split("")) {
      if (pushable.includes(type)) {
        data.removeTypeAt(x, y, type, map);
        data.addTypeAt(newx, newy, type, newmap);
        return true;
      }
    }
  },

  // Checks if it is in bounds and colliding
  isInBounds: (x, y, map = data.currentMap) => {
    if (isNaN(x))
      return false;
    if (isNaN(y))
      return false;
    if (x == null)
      return false;
    if (y == null)
      return false;
    if (map == null)
      return false;
    if (x < 0)
      return false;
    if (y < 0)
      return false;
    if (!data.maps[map])
      return false;
    if (x > data.maps[map].map[0].length - 1)
      return false;
    if (y > data.maps[map].map.length - 1)
      return false;
    return true;
  },
  colliding: (x, y, map = data.currentMap) => {
    if (!data.isInBounds(x, y, map))
      return true;
    if (data.maps[map].map[y][x].split("").some(item => solid.includes(item)))
      return true;
    if (data.maps[map].map[y][x].split("").every(item => item === " " || item == "") && solid.includes(data.maps[map].background))
      return true;
    if (x == data.player.x && y == data.player.y && map == data.currentMap)
      return true;
    return false;
  },

  // The function to update the display
  update: () => {
    if (data.ingame) {
      if (data.inventory.open) {
        setMap(map`
.....
.....
.....
.....`);
        clearText();
        setBackground("⦰");
        let offset = 0
        if (data.inventory.top) {
          offset = data.inventory.at - 2;
          if (offset < 0)
            offset = 0;
          else if (offset + 5 >= data.inventory.max + data.inventory.getBonus("max"))
            offset = data.inventory.max + data.inventory.getBonus("max") - 5;
        }
        for (let x = 0; x < width(); x++) {
          addSprite(x, 0, "◻");
          addSprite(x, 3, "◻");
          if (data.inventory.inventory[x + offset])
            addSprite(x, 0, data.inventory.inventory[x + offset]);
          if (x + offset == data.inventory.at) {
            let y = 3
            if (data.inventory.top)
              y = 0
            addSprite(x, y, "◼");
          }
          if (Object.values(data.inventory.equiped)[x])
            addSprite(x, 3, Object.values(data.inventory.equiped)[x]);
          addText(Object.keys(data.inventory.equiped)[x], {
            color: color`2`,
            y: 10 + x % 2,
            x: x * 4
          })
        }
        if (data.inventory.top) {
          if (data.inventory.data[data.inventory.inventory[data.inventory.at]]) {
            for (let text of data.inventory.data[data.inventory.inventory[data.inventory.at]])
              addText(text.text, text.options)
          }
        } else {
          if (data.inventory.data[Object.values(data.inventory.equiped)[data.inventory.at]]) {
            for (let text of data.inventory.data[Object.values(data.inventory.equiped)[data.inventory.at]])
              addText(text.text, text.options)
          }
        }
      } else if (data.shop.open) {
        setMap(map`
.....
.....
.....
.....`);
        clearText();
        setBackground("⦰");
        let offset = data.shop.at - 2;
        if (offset < 0)
          offset = 0;
        else if (offset + 5 >= Object.keys(data.shop.store).length)
          offset = Object.keys(data.shop.store).length - 5;
        for (let x = 0; x < width(); x++) {
          if (x + offset == data.shop.at)
            addSprite(x, 0, "◼");
          if (Object.values(data.shop.store)[offset + x].display.sprite)
            addSprite(x, 0, Object.values(data.shop.store)[offset + x].display.sprite);
        }
        for (let text of Object.values(data.shop.store)[data.shop.at].display.text)
          addText(text.text, text.options);
        addText("Currently it is\n" + data.shop.get(), { x: 1, y: 9, color: color`1` });
        addText("Price " + data.shop.getPrice(), { x: 1, y: 12, color: color`1` });
        addText("Health: " + Math.ceil(data.player.health) + "HP", { y: 15, color: color`3` });
        addText("Coins: " + Math.ceil(data.player.coins) + "C", { y: 14, color: color`6` });

      } else {
        // Clears the map and sets the background
        setMap(camera);
        setBackground(data.maps[data.currentMap].background);
        // Gets the camera offset
        let offsetX = Math.ceil(data.player.x - width() / 2);
        let offsetY = Math.ceil(data.player.y - height() / 2);
        if (offsetX < 0)
          offsetX = 0;
        if (offsetY < 0)
          offsetY = 0;
        if (offsetX + width() > data.maps[data.currentMap].map[0].length)
          offsetX = data.maps[data.currentMap].map[0].length - width();
        if (offsetY + height() > data.maps[data.currentMap].map.length)
          offsetY = data.maps[data.currentMap].map.length - height();
        // Draws the map
        for (let y = 0; y < height(); y++) {
          for (let x = 0; x < width(); x++) {
            if (data.isInBounds(offsetX + x, offsetY + y)) {
            for (let type of data.maps[data.currentMap].map[offsetY + y][offsetX + x].split("")) {
              if (type !== " ") {
                addSprite(x, y, type);
                if (data.enemy.types.includes(type)) {
                  let health = data.enemy.getEnemyHealth(type, offsetX + x, offsetY + y);
                  if (health != 10 && health > 0 && health)
                    addSprite(x, y, health);
                }
              }
            }
            } else {
              addSprite(x, y, "⦰");
            }
          }
        }
        // Adds the player and all the equiped items
        addSprite(Math.floor(data.player.x - offsetX), Math.floor(data.player.y - offsetY), "☺");
        for (let slot of Object.keys(data.inventory.equiped)) {
          if (data.inventory.equiped[slot]) {
            if (slot == "hands") {
              let x = data.player.x + data.player.lastMove[0];
              let y = data.player.y + data.player.lastMove[1];
              if (!data.isInBounds(x, y)) {
                x = data.player.x;
                y = data.player.y;
              }
              addSprite(Math.floor(x - offsetX), Math.floor(y - offsetY), data.inventory.equiped[slot].toLowerCase());
            } else
              addSprite(Math.floor(data.player.x - offsetX), Math.floor(data.player.y - offsetY), data.inventory.equiped[slot].toLowerCase());
          } else if (slot === "hands") {
            let x = data.player.x + data.player.lastMove[0];
            let y = data.player.y + data.player.lastMove[1];
            if (!data.isInBounds(x, y)) {
              x = data.player.x;
              y = data.player.y;
            }
            addSprite(Math.floor(x - offsetX), Math.floor(y - offsetY), "⌖");
          }
        }
        // Gets the info for the enemy in front of you
        let x = data.player.x + data.player.lastMove[0];
        let y = data.player.y + data.player.lastMove[1];
        let [newMap, newx, newy, dir] = data.interact(x, y, data.currentmap, true);
        if (typeof newMap == 'undefined')
          newMap = data.currentmap;
        if (typeof newx == 'undefined')
          newx = x;
        if (typeof newy == 'undefined')
          newy = y;
        let d = data.enemy.getEnemyData(newx, newy, newMap);
        if (d) {
          addText("Enemy Health: " + Math.round(d.health) + "HP", { y: 12, color: color`3` });
          addText("Enemy Name: " + d.name, { y: 13, color: color`0` });
        }
        // Displays health amount and coin amount and damage percentage sprite
        addText("Health: " + Math.ceil(data.player.health) + "HP", { y: 15, color: color`3` });
        addText("Coins: " + Math.ceil(data.player.coins) + "C", { y: 14, color: color`6` });
        let health = Math.ceil(data.player.health / data.player.maxhealth * 10);
        if (health != 10 && health > 0 && health)
          addSprite(Math.floor(data.player.x - offsetX), Math.floor(data.player.y - offsetY), health);
        // Calles all the check functions
        for (let check = 0; check < data.check.length; check++)
          while (data.check[check] && data.check[check](check)) {}
      }
    } else {
      if (data.menu.howToPlay) {
        setMap(map`
⦰`);
        clearText();
        addText(`Use ijkl to move, w

to open inventory, s

to open shop, d to

drop item/pull box,

a to attack/select/

equip, and any key

to hide this. You

can attack through
entrances/exits.`, { x: 0, y: 0, color: color`2` })
      } else if (data.menu.credits.open) {
        setMap(map`⦰`);
        clearText()

        let list = data.menu.credits.text.slice(data.menu.credits.at[1], data.menu.credits.at[1] + 16)

        let text = "";

        for (let item of list)
          text += item.slice(data.menu.credits.at[0], data.menu.credits.at[0] + 20) + "\n";
        addText(text, {x: 0, y: 0, color: color`2`});
      } else {
        let screen = data.returnIfRandomList("Menu Screen", data.menu.screens.length, ...data.menu.screens);
        setMap(screen.map);
        setBackground(screen.bg);
        clearText();
        for (let idx = 0; idx < Object.keys(data.menu.buttons).length; idx++) {
          let y = Math.floor(height() / 2 - Object.keys(data.menu.buttons).length / 2 + idx * 2);
          for (let x = 0; x < Math.round(width() / 2) + 1; x++) {
            let type = "o";
            if (x == 0)
              type = "q";
            if (x == Math.floor(width() / 2))
              type = "Q";
            addSprite(Math.floor(width() / 4) + x, y, type);
            if (data.menu.y == idx) {
              type = "O";
              if (x == 0)
                type = "\"";
              if (x == Math.floor(width() / 2))
                type = "'";
              addSprite(Math.floor(width() / 4) + x, y, type);
            }
          }
          addText(Object.keys(data.menu.buttons)[idx], { y: Math.round(height() + idx * 4 - Object.keys(data.menu.buttons).length), color: color`0` });
        }
        addText(document.title.replace(" | Sprig", ""), { y: 1, color: color`0` });
      }
    }
  },

  // the function to attack
  attack: () => {
    // Gets where you attack
    let [newmap, x, y, newdir] = data.interact(data.player.x + data.player.lastMove[0], data.player.y + data.player.lastMove[1], data.currentMap, true);
    if (typeof newmap == 'undefined')
      newmap = data.currentMap;
    if (typeof x == 'undefined')
      x = data.player.x + data.player.lastMove[0];
    if (typeof y == 'undefined')
      y = data.player.y + data.player.lastMove[1];
    // Hurts the enemies and breaks the breakable
    if (data.isInBounds(x, y, newmap)) {
      for (let type of data.enemy.types) {
        if (data.maps[newmap].map[y][x].split("").includes(type)) {
          data.enemy.changeEnemyHealth(type, x, y, -data.player.damage - data.inventory.getBonus("damage"), newmap)
        }
      }
      for (let type of Object.keys(breakable)) {
        data.replaceTypeAt(x, y, type, breakable[type], newmap)
      }
    }
  },
};


// Walking Inputs
onInput("\i", () => {
  if (data) {
    data.text.input = true;
    if (data.ingame)
      data.player.move(0, -1);
    else if (!data.menu.howToPlay && !data.menu.credits.open)
      data.menu.move(0, -1);
    else
      data.menu.credits.move(0, -1)
  }
});
onInput("\j", () => {
  if (data) {
    data.text.input = true;
    if (data.ingame)
      data.player.move(-1, 0);
    else if (!data.menu.howToPlay && !data.menu.credits.open)
      data.menu.move(-1, 0);
    else
      data.menu.credits.move(-1, 0)
  }
});
onInput("\k", () => {
  if (data) {
    data.text.input = true;
    if (data.ingame)
      data.player.move(0, 1);
    else if (!data.menu.howToPlay && !data.menu.credits.open)
      data.menu.move(0, 1);
    else
      data.menu.credits.move(0, 1)
  }
});
onInput("\l", () => {
  if (data) {
    data.text.input = true;
    if (data.ingame)
      data.player.move(1, 0);
    else if (!data.menu.howToPlay && !data.menu.credits.open)
      data.menu.move(1, 0);
    else
      data.menu.credits.move(1, 0)
  }
});

// Action inputs
onInput("\w", () => {
  if (data) {
    if (data.ingame) {
      data.shop.open = false;
      data.inventory.open = !data.inventory.open;
      if (data.inventory.open)
        playTune(tune`
  166.66666666666666: C4-166.66666666666666,
  166.66666666666666: D4-166.66666666666666,
  5000`);
      else
        playTune(tune`
  125: D4-125,
  125: C4-125,
  3750`);
    } else
      data.menu.credits.open = false;
  }
});
onInput("\a", () => {
  if (data) {
    if (data.ingame) {
      if (data.inventory.open) {
        if (data.inventory.use())
          playTune(tune`
  500: C4~500,
  15500`);
      } else if (data.shop.open) {
        if (data.shop.buy())
          playTune(tune`
  500: B5/500,
  15500`);
      } else {
        if (!data.text.input)
          data.text.input = true;
        data.attack();
        /*playTune(tune`
  500: C4-500,
  15500`);*/
      }
    } else if (!data.menu.howToPlay && !data.menu.credits.open)
      data.menu.select();
    else
      data.menu.credits.open = false;
  }
  
});
onInput("\s", () => {
  if (data) {
    if (data.ingame) {
      data.inventory.open = false;
      data.shop.open = !data.shop.open;
      if (data.shop.open)
        playTune(tune`
  166.66666666666666: C4-166.66666666666666,
  166.66666666666666: D4-166.66666666666666,
  5000`);
      else
        playTune(tune`
  125: D4-125,
  125: C4-125,
  3750`);
    } else
      data.menu.credits.open = false;
  }
});
onInput("\d", () => {
  if (data) {
    if (data.ingame) {
      if (data.inventory.open)
        data.inventory.drop();
      else if (!data.shop.open) {
        if (data.ispush(data.player.x + data.player.lastMove[0] * 2, data.player.y + data.player.lastMove[1] * 2)) {
          if (data.push(data.player.x + data.player.lastMove[0] * 2, data.player.y + data.player.lastMove[1] * 2, [-data.player.lastMove[0], -data.player.lastMove[1]])) {
            if (!data.text.input)
              data.text.input = true;
            playTune(tune`
  500: D4-500,
  15500`);
          }
        }
      }
    } else
      data.menu.credits.open = false;
  }
});

// Update and other stuff after input
afterInput(() => {
  if (data) {
    eval(data.afterInputEval);
    data.afterInputEval = ``;
    if (data.ingame) {
      if (!data.inventory.open) {
        if (debug.logPos && debug.logMap)
          console.log([data.player.x, data.player.y, data.currentMap]);
        else if (debug.logPos)
          console.log([data.player.x, data.player.y]);
        else if (debug.logMap)
          console.log(data.currentMap);
        clearText()
        if (!data.text.input) {
          addText(data.text.text, data.text.options);
        }
      }
    }
    data.menu.howToPlay = false;
    data.update();
  }
});

// I'm too lasy to set variables for all of them
setLegend(
  ["\"", bitmap`
................
................
................
................
2222200000000222
2222111111111122
2221111111111112
2211111111111111
2111111111111111
0111111111111111
0111111111111111
2111111111111111
2211111111111111
22L111111111111L
22LL1111111111LL
2LLLL00000000LLL`], // Button select left
  ["O", bitmap`
................
................
................
................
2220000000000222
2211111111111122
2111111111111112
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
L11111111111111L
LL111111111111LL
LLL0000000000LLL`], // Button select middle
  ["'", bitmap`
................
................
................
................
2220000000022222
2211111111112222
2111111111111LL2
11111111111111LL
111111111111111L
1111111111111110
1111111111111110
111111111111111L
11111111111111LL
L111111111111LLL
LL1111111111LLLL
LLL00000000LLLLL`], // Button select right

  ["q", bitmap`
................
................
................
................
0000000000000000
0222111111111111
0221111111111111
0211111111111111
0111111111111111
0111111111111111
0111111111111111
0111111111111111
0211111111111111
02L1111111111111
02LL111111111111
0000000000000000`], // Button left
  ["o", bitmap`
................
................
................
................
0000000000000000
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
0000000000000000`], // Button middle
  ["Q", bitmap`
................
................
................
................
0000000000000000
1111111111112220
1111111111111LL0
11111111111111L0
1111111111111110
1111111111111110
1111111111111110
1111111111111110
11111111111111L0
1111111111111LL0
111111111111LLL0
0000000000000000`], // Button right

  ["◼", bitmap`
2222........2222
222..........22L
22............LL
2..............L
................
................
................
................
................
................
................
................
2..............L
22............LL
22L..........LLL
2LLL........LLLL`], // slot selection

  ["!", bitmap`
.......00.......
......0110......
......0110......
......0110......
......0110......
.....011110.....
.....011110.....
.....011110.....
.....011110.....
.....011110.....
....00000000....
...0333333330...
....00000000....
......0LL0......
......0LL0......
.......00.......`], // Sword
  ["#", bitmap`
................
...0000000000...
..0CCFCCCCFCC0..
..0CCFCCCCFCC0..
..0CCFCCCCFCC0..
..0CCFCCCCFCC0..
..0CCFCCCCFCC0..
..0CCFCCCCFCC0..
..0CCFCCCCFCC0..
..0CCFCCCCFCC0..
..0CCFCCCCFCC0..
..0C1FCCCCF1C0..
..0CCF1CC1FCC0..
...00FCCCCF00...
.....00CC00.....
.......00.......`], // Sheild

  ["h", bitmap`
....00000000....
...0777777770...
..077777777770..
.07700000000770.
0770555555550770
0000000000000000
................
................
................
................
................
................
................
................
................
................`], // Hat
  ["B", bitmap`
..000000000000..
.00CCCCCCCCCC00.
.00CCCCCCCCCC00.
.000CCCCCCCC000.
.0000CCCCCC0000.
.0C00CCCCCC00C0.
.0C00CCCCCC00C0.
.0C00CCCCCC00C0.
.0C00CCCCCC00C0.
.0C00CCCCCC00C0.
.0C00CCCCCC00C0.
.0000CCCCCC0000.
.000CCCCCCCC000.
.00CCCCCCCCCC00.
.00CCCCCCCCCC00.
..000000000000..`], // Bag
  ["b", bitmap`
....00000000....
...0........0...
..0..........0..
.0............0.
0..............0
0...20....20...0
00..00....00..00
0.0..........0.0
0.0..........0.0
0.0..........0.0
0.0.0......0.0.0
0.0..000000..0.0
.00..........00.
..0..........0..
...0........0...
....00000000....`], // Bag display

  ["♥", bitmap`
................
................
......0000......
.....0FFCC0.....
.....0FCCC0.....
......0230......
.....023330.....
....02333330....
....03333330....
....03333330....
....03333330....
....03333330....
....03333330....
.....000000.....
................
................`], // Healing potion
  ["k", bitmap`
......0000......
.....066660.....
....06666660....
....06666660....
....06666660....
....06666660....
.....066660.....
......0000......
......060.......
......06600.....
......066660....
......06600.....
......060.......
......06600.....
......066660....
.......0000.....`], // Gold Key
  ["K", bitmap`
......0000......
.....011110.....
....01111110....
....01111110....
....01111110....
....01111110....
.....011110.....
......0000......
......010.......
......01100.....
......011110....
......01100.....
......010.......
......01100.....
......011110....
.......0000.....`], // Silver Key
  ["Ⅎ", bitmap`
......0000......
.....0FFFF0.....
....0FFFFFF0....
....0FFFFFF0....
....0FFFFFF0....
....0FFFFFF0....
.....0FFFF0.....
......0000......
......0F0.......
......0FF00.....
......0FFFF0....
......0FF00.....
......0F0.......
......0FF00.....
......0FFFF0....
.......0000.....`], // Bronze Key

  ["⌖", bitmap`
................
................
................
................
......0000......
.....066660.....
....06666660....
....06666660....
....06666660....
....06666660....
.....066660.....
......0000......
................
................
................
................`], // hand

  ["♜", bitmap`
................
................
0000000000000000
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0000000000000000
0CCCCC0660CCCCC0
0CCCCC0660CCCCC0
0CCCCC0000CCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0000000000000000`], // Chest
  ["♖", bitmap`
0000000000000000
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0000000000000000
0LLLLL0660LLLLL0
0000000660000000
0CCCCC0000CCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0000000000000000`], // Chest open

  ["☘", bitmap`
2200000220000022
2004440000444002
2044444004444402
2044444004444402
2044444004444402
2004440000444002
2100000000000012
2004440000444002
2044444004444402
2044444004444402
2044444004444402
2004440000444002
2100000000000012
2111110440111112
2111110440111112
2222220000222222`], // Luck
  ["⚔", bitmap`
2222002222222222
2110110111111112
2110110111111112
2110110111111112
2110110111111112
2101111011111112
2101111011111212
2101111011111212
2101111011122222
2101111011111212
2000000001111212
0333333330111112
2000000001111112
2110LL0111111112
2110LL0111111112
2222002222222222`], // Damage
  ["0", bitmap`
2222222222222222
2111111111111112
2111111111111112
0000000000111112
0111111110111112
0111111110111112
0111111110111212
0111111110111212
0111111110122222
0111111110111212
0111111110111212
0111111110111112
0000000000111112
2111111111111112
2111111111111112
2222222222222222`], // max inventory slots
  ["❣", bitmap`
2222222222222222
2000111100011112
0333011033301112
0333300333301112
0333333333301112
0333333333301112
2033333333011212
2103333330111212
2103333330122222
2110333301111212
2110333301111212
2111033011111112
2111033011111112
2111100111111112
2111111111111112
2222222222222222`], // max health
  [" ", bitmap`
2222222222222222
2000000000011112
0CCFCCCCFCC01112
0CCFCCCCFCC01112
0CCFCCCCFCC01212
0CCFCCCCFCC01212
0CCFCCCCFCC02222
0CCFCCCCFCC01212
0CCFCCCCFCC01212
0CCFCCCCFCC01112
0CCFCCCCFCC01112
0C1FCCCCF1C01112
0CCF1CC1FCC01112
200FCCCCF0011112
21100CC001111112
2222200222222222`], // Protection

  ["1", bitmap`
....00000000....
...00.0.0..00...
..0..0.0.00..0..
.0.00.0.00.00.0.
0.0.0..0.00..0.0
00.0..0.0.....00
0.0....0.0...0.0
00.0..0.0.0.0.00
0.0.0.0.00.0.000
00.0.0.0..0.0.00
00.0..0..0...0.0
0.0.0.......0.00
.0.0.0.00.000.0.
..0.0.0.00.0.0..
...0.0.0..0.0...
....00000000....`], // Health 1
  ["2", bitmap`
....00000000....
...00.0.0..00...
..0..0.0.00..0..
.0.00.0.00.00.0.
0...0..0.00..0.0
00.0....0.....00
0.0..........0.0
00.0........0.00
0.0.0.0..0.0.000
00.0.0....0.0.00
00.0..0..0...0.0
0.0.0.......0.00
.0.0.0..0.000.0.
..0.0.0.00.0.0..
...0.0.0..0.0...
....00000000....`], // Health 2
  ["3", bitmap`
....00000000....
...00.0.0..00...
..0..0.0.00..0..
.0.00.0.00.00.0.
0...0....00..0.0
00.0..........00
0.0..........0.0
00.0........0.00
0.0.0......0.000
00.0......0.0.00
00.0.........0.0
0.0.0.......0.00
.0.0.0..0.000.0.
..0.0.0.00.0.0..
...0.0.0..0.0...
....00000000....`], // Health 3
  ["4", bitmap`
....00000000....
...00.0.0..00...
..0..0.0..0..0..
.0.0..0.00.00.0.
0...0....00..0.0
00.0..........00
0.0..........0.0
00.0........0.00
0.0.0......0.000
00.0......0.0..0
00...........0.0
0.0.........0.00
.0.0.0..0..00.0.
..0.0...00...0..
...0.0.0..0.0...
....00000000....`], // Health 4
  ["5", bitmap`
....00000000....
...00...0..00...
..0..0.0..0..0..
.0.0....0..00.0.
0...0....00..0.0
00.0..........00
0.0..........0.0
0..0........0..0
0.0........0.000
00.0........0..0
00...........0.0
0.0.........0..0
.0.0.0..0..00.0.
..0.0...00...0..
...0...0..0.0...
....00000000....`], // Health 5
  ["6", bitmap`
....00000000....
...00...0..00...
..0....0.....0..
.0.0....0..00.0.
0...0....00....0
00.0..........00
0.0..........0.0
0..0........0..0
0.0........0.000
00..........0..0
00...........0.0
0.0.........0..0
.0.0........0.0.
..0.0...00...0..
...0...0..0.0...
....00000000....`], // Health 6
  ["7", bitmap`
....00000000....
...0....0...0...
..0....0.....0..
.0.0....0..00.0.
0...0.....0....0
00............00
0.0..........0.0
0..0........0..0
0.0..........000
00.............0
00...........0.0
0.0.........0..0
.0.0........0.0.
..0.....00...0..
...0...0....0...
....00000000....`], // Health 7
  ["8", bitmap`
....00000000....
...0....0...0...
..0....0.....0..
.0.0.......00.0.
0..............0
00............00
0.0..........0.0
0..............0
0.0..........000
00.............0
0..............0
0.0.........0..0
.0.0........0.0.
..0.....0....0..
...0...0....0...
....00000000....`], // Health 8
  ["9", bitmap`
....00000000....
...0....0...0...
..0..........0..
.0..........0.0.
0..............0
00............00
0..............0
0..............0
0.............00
00.............0
0..............0
0..............0
.0.0........0.0.
..0..........0..
...0...0....0...
....00000000....`], // Health 9
  ["☺", bitmap`
....00000000....
...0666666660...
..066666666660..
.06666666666660.
0666666666666660
0666206666206660
0666006666006660
0666666666666660
0666666666666660
0666666666666660
0666066666606660
0666600000066660
.06666666666660.
..066666666660..
...0666666660...
....00000000....`], // Player
  ["e", bitmap`
....00000000....
...0LLLLLLLL0...
..0LLLLLLLLLL0..
.0LLLLLLLLLLLL0.
0LLLLLLLLLLLLLL0
0LLL20LLLL20LLL0
0LLL00LLLL00LLL0
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
0LLL0LLLLLL0LLL0
0LLLL000000LLLL0
.0LLLLLLLLLLLL0.
..0LLLLLLLLLL0..
...0LLLLLLLL0...
....00000000....`], // Enemy
  ["E", bitmap`
....00000000....
...04DL4DLD40...
..04DLLL4DLD40..
.04DLLLL4DLLD40.
04DLLLL4DLLLLD40
0DLL20L4DL20LLD0
0LLL00LL4D00LLL0
0LLLLLL4DLLLLLL0
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
04LL0LLLLLL0LL40
0D4LL000000LL4D0
.0D4LLLLLLLL4D0.
..0D4LLLLLL4D0..
...0D4LLLL4D0...
....00000000....`], // Enemy grass
  ["w", bitmap`
....00000000....
...075L75L570...
..075LLL75L570..
.075LLLL75LL570.
075LLLL75LLLL570
05LL20L75L20LL50
0LLL00LL7500LLL0
0LLLLLL75LLLLLL0
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
07LL0LLLLLL0LL70
057LL000000LL750
.057LLLLLLLL750.
..057LLLLLL750..
...057LLLL750...
....00000000....`], // Enemy water
  ["m", bitmap`
....00000000....
...06FL6FLF60...
..06FLLL6FLF60..
.06FLLLL6FLLF60.
06FLLLL6FLLLLF60
0FLL20L6FL20LLF0
0LLL00LL6F00LLL0
0LLLLLL6FLLLLLL0
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
06LL0LLLLLL0LL60
0F6LL000000LL6F0
.0F6LLLLLLLL6F0.
..0F6LLLLLL6F0..
...0F6LLLL6F0...
....00000000....`], // Enemy sand
  ["M", bitmap`
....00000000....
...010L10L010...
..010LLL10L010..
.010LLLL10LL010.
010LLLL10LLLL010
00LL20L10L20LL00
0LLL00LL1000LLL0
0LLLLLL10LLLLLL0
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
01LL0LLLLLL0LL10
001LL000000LL100
.001LLLLLLLL100.
..001LLLLLL100..
...001LLLL100...
....00000000....`], // Enemy mine
  ["℥", bitmap`
....00000000....
...0111111110...
..011111111110..
.01111111111110.
0111111111111110
0111201111201110
0111001111001110
0111111111111110
0111111111111110
0111111111111110
0111011111101110
0111100000011110
.01111111111110.
..011111111110..
...0111111110...
....00000000....`], // Enemy boss

  ["❶", bitmap`
....00000000....
...0000000000...
..000666666000..
.00066000066000.
0006606666066000
0066606666666600
0066606666666600
0066606666666600
0066606666666600
0066606666666600
0066606666666600
0006606666066000
.00066000066000.
..000666666000..
...0000000000...
....00000000....`], // Gold Coin 🪙
  ["➋", bitmap`
....00000000....
...0000000000...
..000111111000..
.00011000011000.
0001101111011000
0011101111111100
0011101111111100
0011101111111100
0011101111111100
0011101111111100
0011101111111100
0001101111011000
.00011000011000.
..000111111000..
...0000000000...
....00000000....`], // Silver Coin 🪙
  ["➌", bitmap`
....00000000....
...0000000000...
..000FFFFFF000..
.000FF0000FF000.
000FF0FFFF0FF000
00FFF0FFFFFFFF00
00FFF0FFFFFFFF00
00FFF0FFFFFFFF00
00FFF0FFFFFFFF00
00FFF0FFFFFFFF00
00FFF0FFFFFFFF00
000FF0FFFF0FF000
.000FF0000FF000.
..000FFFFFF000..
...0000000000...
....00000000....`], // Bronze Coin 🪙

  ["←", bitmap`
.......00.......
......0LL0......
.....0LLLL0.....
....0LLLLLL0....
...0LLLLLLLL0...
..0LLLLLLLLLL0..
.0LLLLL00LLLLL0.
0LLLLL0000LLLLL0
0LLLLLL00LLLLLL0
.0LLLL0000LLLL0.
..0LLL0LL0LLL0..
...0LLLLLLLL0...
....0LLLLLL0....
.....0LLLL0.....
......0LL0......
.......00.......`], // Gem
  ["↑", bitmap`
.......00.......
......04D0......
.....0DD440.....
....04DD4440....
...0444444440...
..0D4444444440..
.04444D00D44440.
0D44440000444440
04444440044444D0
.04444000044440.
..0D440D4044D0..
...044DD44440...
....044444D0....
.....044440.....
......0440......
.......00.......`], // Gem grass
  ["→", bitmap`
.......00.......
......0750......
.....055770.....
....07557770....
...0777777770...
..057777777770..
.07777500577770.
0577770000777770
0777777007777750
.07777000077770.
..057705707750..
...0775577770...
....07777750....
.....077770.....
......0770......
.......00.......`], // Gem water
  ["↓", bitmap`
.......00.......
......06F0......
.....0FF660.....
....06FF6660....
...0666666660...
..0F6666666660..
.06666F00F66660.
0F66660000666660
06666660066666F0
.06666000066660.
..0F660F6066F0..
...066FF66660...
....066666F0....
.....066660.....
......0660......
.......00.......`], // Gem sand
  ["↔", bitmap`
.......00.......
......01L0......
.....0LL110.....
....01LL1110....
...0111111110...
..0L1111111110..
.01111L00L11110.
0L11110000111110
01111110011111L0
.01111000011110.
..0L110L1011L0..
...011LL11110...
....011111L0....
.....011110.....
......0110......
.......00.......`], // Gem mine

  ["⌧", bitmap`
0000000000000000
00CCCCCCCCCCCC00
0C0CCCCCCCCCC0C0
0CC0CCCCCCCC0CC0
0CCC0CCCCCC0CCC0
0CCCC0CCCC0CCCC0
0CCCCC0CC0CCCCC0
0CCCCCC00CCCCCC0
0CCCCCC00CCCCCC0
0CCCCC0CC0CCCCC0
0CCCC0CCCC0CCCC0
0CCC0CCCCCC0CCC0
0CC0CCCCCCCC0CC0
0C0CCCCCCCCCC0C0
00CCCCCCCCCCCC00
0000000000000000`], // Box
  ["⌬", bitmap`
000000....000000
00CCC......CCC00
0C0C........C0C0
0CC0........0CC0
0C..0......0..C0
0..............0
................
................
................
................
0..............0
0C..0......0..C0
0CC0........0CC0
0C0C........C0C0
00CCC......CCC00
000000....000000`], // Box broken

  ["⊟", bitmap`
  ..000000000000..
  ..0DC4C44C4CD0..
  .0DCCCCCCCCCCD0.
  .0CC4C4CC4C4CC0.
0DC4CCCCCCCC4CD0
0000000000000000
  .0LLLLLLLLLLLL0.
  .0L1111111111L0.
  .01111111111110.
  .01111777711110.
  .01111777711110.
  .01111277711110.
  .0111144DD11110.
  .01111000011110.
  .01111LLLL11110.
  .00000000000000.`], // Home side
  ["⌂", bitmap`
  .......00.......
  .....00CC00.....
  ...00DC77CD00...
  ..0DCC4274CCD0..
  .0DC4CC4DCC4CD0.
0000000000000000
  .0LLLLLLLLLLLL0.
  .0L1111111111L0.
  .01111111111110.
  .01111111111110.
  .01111000011110.
  .01111011011110.
  .0144100101DD10.
  .01001011010010.
  .01LL101101LL10.
  .00000000000000.`], // Home front
  ["△", bitmap`
.......00.......
......0660......
......0FF0......
.....000000.....
.....066660.....
....0FFFFFF0....
....00000000....
...0666666660...
...0FFFFFFFF0...
..000000000000..
..066666666660..
.0FFFFFFFFFFFF0.
.00000000000000.
0666666666666660
0FFFFFFFFFFFFFF0
0000000000000000`], // Pyramid
  ["@", bitmap`
....00000000....
...00LLLLLL00...
..00LLLLLLLL00..
.00LLLLLLLLLL00.
00LLLLLLLLLLLL00
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
0LLLL111111LLLL0
0LLL11111111LLL0
0LL1111111111LL0
0L111111111111L0
0111111111111110
0000000000000000`], // Mine ⛏

  ["C", bitmap`
  ................
  .00000000000000.
  .07777777777770.
  .07777777777770.
  .07777722777770.
  .07777243277770.
  .077772D3277770.
  .07777722777770.
  .07777777777770.
  .07777777777770.
  .00000000000000.
  ..0L1L1L1L1L10..
  .0L1L1L1L1L1L10.
  .01L1111111L1L0.
0LL1LL1LLLL1L1L0
0000000000000000`], // Computer
  ["c", bitmap`
  ..00000000......
  ..01111110......
  ..01111110......
  ..01111110......
  ..01111110......
  ..01111110......
  ..011111100.....
  ..01111110L00...
  ..01111110LLL0..
  ..01111110LL00..
  ..01111110L0.0..
  ..000000000..0..
  ..0...0..0...0..
  ..0...0..0...0..
  ..0...0..0...0..
  ..0......0......`], // Chair

  ["d", bitmap`
..000000000000..
..011111111110..
..011111111110..
..011111111110..
..011111111110..
..011111111110..
..011001111110..
..011001111110..
..011111111110..
..011111111110..
..011111111110..
..011111111110..
..011111111110..
..011111111110..
..011111111110..
..000000000000..`], // Home door

  ["⊞", bitmap`
0000000000000000
0777772207772220
0777772207772220
0777777707772220
0777777707777770
0557777707777770
0557777705777770
0000000000000000
0777777207777220
0777777707777220
0777777707777770
0777777707777770
0555777707777770
0555777705577770
0555777705577770
0000000000000000`], // Home window
  ["⊠", bitmap`
0000000000000000
0777772207772220
0777772207772220
0777777702772220
077777222.277770
055772....277770
05572......27770
0002.......20000
07772.......2220
07772.2...227220
07777272.2777770
0777772...277770
0555777222777770
0555777705577770
0555777705577770
0000000000000000`], // broken window

  ["T", bitmap`
.......00.......
......0DD0......
.....0DDDD0.....
....0DDDDDD0....
.....0DDDD0.....
....0DDDDDD0....
...0DDDDDDDD0...
..0DDDDDDDDDD0..
...0DDDDDDDD0...
..0DDDDDDDDDD0..
.0DDDDDDDDDDDD0.
0000000000000000
......0CC0......
......0CC0......
......0CC0......
......0000......`], // Tree
  ["t", bitmap`
0000000000000000
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0CCCCCCCCCCCCCC0
0000000000000000
0FFFFFFFFFFFFFF0
0FFFFFF00FFFFFF0
0FFFFFFFFFFFFFF0
0000000000000000
0..............0
0..............0
0..............0
0..............0`], // Table

  ["s", bitmap`
0000000000000000
0111111111111110
0000000000000000
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
0000000000000000
0111111111111110
0000000000000000
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
0000000000000000
0111111111111110
0000000000000000
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
0000000000000000`], // Home stairs up
  ["S", bitmap`
0000000000000000
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
0000000000000000
0111111111111110
0000000000000000
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
0000000000000000
0111111111111110
0000000000000000
0LLLLLLLLLLLLLL0
0LLLLLLLLLLLLLL0
0000000000000000
0111111111111110
0000000000000000`], // Home stairs down

  ["↰", bitmap`
0000000000000000
0666666666666660
0000000000000000
0FFFFFFFFFFFFFF0
0FFFFFFFFFFFFFF0
0000000000000000
0666666666666660
0000000000000000
0FFFFFFFFFFFFFF0
0FFFFFFFFFFFFFF0
0000000000000000
0666666666666660
0000000000000000
0FFFFFFFFFFFFFF0
0FFFFFFFFFFFFFF0
0000000000000000`], // Sand stairs up
  ["↱", bitmap`
0000000000000000
0FFFFFFFFFFFFFF0
0FFFFFFFFFFFFFF0
0000000000000000
0666666666666660
0000000000000000
0FFFFFFFFFFFFFF0
0FFFFFFFFFFFFFF0
0000000000000000
0666666666666660
0000000000000000
0FFFFFFFFFFFFFF0
0FFFFFFFFFFFFFF0
0000000000000000
0666666666666660
0000000000000000`], // Sand stairs down

  ["|", bitmap`
0000000000000000
0FFFF6666FFFF660
0FFFF6666FFFF660
0000000000000000
0FF6666FFFF66660
0FF6666FFFF66660
0000000000000000
06666FFFF6666FF0
06666FFFF6666FF0
0000000000000000
066FFFF6666FFFF0
066FFFF6666FFFF0
0000000000000000
0FFFF6666FFFF660
0FFFF6666FFFF660
0000000000000000`], // Solid sand wall
  ["/", bitmap`
0000000000000000
0F06666666666060
0F06666666666060
0006666666666000
0F06666666666060
0F06666666666060
00066FF666666000
06066FF6666660F0
06066666666660F0
0006666666666000
06066666666660F0
06066666666660F0
0006666666666000
0F06666666666060
0F06666666666060
0000000000000000`], // Solid sand door
  ["\\", bitmap`
000........00000
0F0........00060
0F0........00060
000........00000
0F0........00060
0F0........00060
000........00000
060........000F0
060........000F0
000........00000
060........000F0
060........000F0
000........00000
0F0........00060
0F0........00060
000........00000`], // Solid sand door open

  ["P", bitmap`
FFFFFFFFFFFFFFFF
FFFFFFFFFFFFFFFF
FFFFFFFFFFFFFFFF
FFFFFFFFFFFFFFFF
FFFFFFFFFF..FFFF
FFFFFFFFFF..FFFF
FFFFFFFFFFFFFFFF
FFFFFFFFFFFFFFFF
FFFF..FFFFFFFF..
FFFF..FFFFFFFF..
FFFFFFFFFFFFFFFF
FFFFFFFFFFFFFFFF
FFFFFFFFFFFFFFFF
FFFFFFFFFFFFFFFF
..FFFFFFFFFFFFFF
..FFFFFFFFFFFFFF`], // Path
  ["G", bitmap`
CFFFFFFFCFFFFFFF
CFFFFFFFCFFFFFFF
CFFFFFFFCFFFFFFF
CCCCCCCCCCCCCCCC
FFFFCFFFFFFFCFFF
FFFFCFFFFFFFCFFF
FFFFCFFFFFFFCFFF
CCCCCCCCCCCCCCCC
CFFFFFFFCFFFFFFF
CFFFFFFFCFFFFFFF
CFFFFFFFCFFFFFFF
CCCCCCCCCCCCCCCC
FFFFCFFFFFFFCFFF
FFFFCFFFFFFFCFFF
FFFFCFFFFFFFCFFF
CCCCCCCCCCCCCCCC`], // Ground inside home
  ["%", bitmap`
7777777755777755
7557777755777755
7557775577775577
7777775577775577
7755777777777777
7755777777777777
5577775555777777
5577775555777777
7777777777777755
7777777777777755
7755775577775577
7755775577775577
7777777777557777
7777777777557777
5577557777777755
5577557777777755`], // Sea
  ["↉", bitmap`
................
................
................
................
..........66....
..........66....
................
................
....66........66
....66........66
................
................
................
................
66..............
66..............`], // Sandy
  ["*", bitmap`
6666666666666666
6666666666666666
6666666666666666
6666666666666666
6666666666..6666
6666666666..6666
6666666666666666
6666666666666666
6666..66666666..
6666..66666666..
6666666666666666
6666666666666666
6666666666666666
6666666666666666
..66666666666666
..66666666666666`], // Paved Sand
  ["&", bitmap`
66666666FF6666FF
6FF66666FF6666FF
6FF666FF6666FF66
666666FF6666FF66
66FF666666666666
66FF666666666666
FF6666FFFF666666
FF6666FFFF666666
66666666666666FF
66666666666666FF
66FF66FF6666FF66
66FF66FF6666FF66
6666666666FF6666
6666666666FF6666
FF66FF66666666FF
FF66FF66666666FF`], // Sand
  ["g", bitmap`
44444444DD4444DD
4DD44444DD4444DD
4DD444DD4444DD44
444444DD4444DD44
44DD444444444444
44DD444444444444
DD4444DDDD444444
DD4444DDDD444444
44444444444444DD
44444444444444DD
44DD44DD4444DD44
44DD44DD4444DD44
4444444444DD4444
4444444444DD4444
DD44DD44444444DD
DD44DD44444444DD`], // Grass
  ["⚪", bitmap`
11111111LL1111LL
1LL11111LL1111LL
1LL111LL1111LL11
111111LL1111LL11
11LL111111111111
11LL111111111111
LL1111LLLL111111
LL1111LLLL111111
11111111111111LL
11111111111111LL
11LL11LL1111LL11
11LL11LL1111LL11
1111111111LL1111
1111111111LL1111
LL11LL11111111LL
LL11LL11111111LL`], // Rock
  ["⦰", bitmap`
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000
0000000000000000`], // Empty void
  ["◻", bitmap`
0000000000000000
0111111111111110
0111111111111110
0111111111111110
0111111111111110
0111111111111110
0111111111111110
0111111111111110
0111111111111110
0111111111111110
0111111111111110
0111111111111110
0111111111111110
0111111111111110
0111111111111110
0000000000000000`], // Inventory slot
  /**/);

// Start display
data.update();

// This might be buggy but it is for merging start with data 
function merge(dat, merg) {
  if (typeof merg === "object" && !Array.isArray(merg)) {
    for (let key of Object.keys(merg)) {
      if (merg[key] === null)
        dat[key] = null;
      else if (typeof merg[key] === "function")
        dat[key] = merg[key];
      else if (Array.isArray(merg[key])) {
        if (key.includes("Names")) {
          dat[key] = randomClone(merg[key]);
        } else {
          try {
            dat[key] = structuredClone(merg[key]);
          } catch {
            dat[key] = merg[key];
          }
        }
      } else if (typeof merg[key] === "object") {
        if (!dat[key])
          dat[key] = {}
        dat[key] = merge(dat[key], merg[key]);
      } else
        dat[key] = structuredClone(merg[key]);
    }
  }
  return dat;
};

// This is to check if the smily shape is in the map
function isInCurrentMap(search, distancex, distancey) {
  let end = false;
  for (let searchY = 0; searchY < search.length && !end; searchY++) {
    for (let searchX = 0; searchX < search[searchY].length && !end; searchX++) {
      if (!data.isInBounds(data.player.x + distancex + searchX, data.player.y + distancey + searchY) || data.isInBounds(data.player.x + distancex + searchX, data.player.y + distancey + searchY) && !data.maps[data.currentMap].map[data.player.y + distancey + searchY][data.player.x + distancex + searchX].includes(search[searchY][searchX]))
        end = true;
    }
  }
  return !end;
};

// It randomizes a list and returns the new list
function randomClone(list) {
  let newList = [];
  let left = [];
  for (let c = 0; c < list.length; c++) {
    left.push(c);
  }
  for (let c = 0; c < list.length; c++) {
    let pick = Math.floor(Math.random() * left.length);
    newList.push(list[left[pick]]);
    left.splice(pick, 1);
  }
  return newList;
}
