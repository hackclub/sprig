/*
@title: cheatcode
@description: ↑↑↓↓←→←→BA
@author: spheroidon
@tags: ['arcade']
@addedOn: 2025-08-24

Check the tutorial in the bottom right, the run button is in the top right.
Make sure to remix this tutorial if you want to save your progress!
*/

// define the sprites in our game
const up = "u";
const down = "d";
const left = "l";
const right = "r";
const buttonb = "b";
const buttona = "a";

const up2 = "1";
const down2 = "2";
const left2 = "3";
const right2 = "4";
const buttonb2 = "5";
const buttona2 = "6";

const bg = "g";

// assign bitmap art to each sprite
setLegend([up, bitmap`
1111111001111111
1111110110111111
1111101111011111
1111011111101111
1110111111110111
1110001111000111
1111101111011111
1111101111011111
1111101111011111
1111101111011111
1111101111011111
1111101111011111
1111101111011111
1111101111011111
1111101111011111
1111100000011111`],
          [down, bitmap`
1111100000011111
1111101111011111
1111101111011111
1111101111011111
1111101111011111
1111101111011111
1111101111011111
1111101111011111
1111101111011111
1111101111011111
1110001111000111
1110111111110111
1111011111101111
1111101111011111
1111110110111111
1111111001111111`],
          [left, bitmap`
1111111111111111
1111111111111111
1111111111111111
1111001111111111
1110101111111111
1101100000000000
1011111111111110
0111111111111110
0111111111111110
1011111111111110
1101100000000000
1110101111111111
1111001111111111
1111111111111111
1111111111111111
1111111111111111`],
          [right, bitmap`
1111111111111111
1111111111111111
1111111111111111
1111111111001111
1111111111010111
0000000000011011
0111111111111101
0111111111111110
0111111111111110
0111111111111101
0000000000011011
1111111111010111
1111111111001111
1111111111111111
1111111111111111
1111111111111111`],
          [buttonb, bitmap`
1111111111111111
1111111111111111
1100000000000011
1101111111111011
1101100000111011
1101101111011011
1101101111011011
1101100000111011
1101101111011011
1101101111011011
1101101111011011
1101100000111011
1101111111111011
1100000000000011
1111111111111111
1111111111111111`],
          [buttona, bitmap`
1111111111111111
1111111111111111
1100000000000011
1101111111111011
1101111001111011
1101110110111011
1101101111011011
1101101111011011
1101100000011011
1101101111011011
1101101111011011
1101101111011011
1101111111111011
1100000000000011
1111111111111111
1111111111111111`],
          [up2, bitmap`
1111111221111111
1111112112111111
1111121111211111
1111211111121111
1112111111112111
1112221111222111
1111121111211111
1111121111211111
1111121111211111
1111121111211111
1111121111211111
1111121111211111
1111121111211111
1111121111211111
1111121111211111
1111122222211111`],
          [down2, bitmap`
1111122222211111
1111121111211111
1111121111211111
1111121111211111
1111121111211111
1111121111211111
1111121111211111
1111121111211111
1111121111211111
1111121111211111
1112221111222111
1112111111112111
1111211111121111
1111121111211111
1111112112111111
1111111221111111`],
          [left2, bitmap`
1111111111111111
1111111111111111
1111111111111111
1111221111111111
1112121111111111
1121122222222222
1211111111111112
2111111111111112
2111111111111112
1211111111111112
1121122222222222
1112121111111111
1111221111111111
1111111111111111
1111111111111111
1111111111111111`],
          [right2, bitmap`
1111111111111111
1111111111111111
1111111111111111
1111111111221111
1111111111212111
2222222222211211
2111111111111121
2111111111111112
2111111111111112
2111111111111121
2222222222211211
1111111111212111
1111111111221111
1111111111111111
1111111111111111
1111111111111111`],
          [buttonb2, bitmap`
1111111111111111
1111111111111111
1122222222222211
1121111111111211
1121122222111211
1121121111211211
1121121111211211
1121122222111211
1121121111211211
1121121111211211
1121121111211211
1121122222111211
1121111111111211
1122222222222211
1111111111111111
1111111111111111`],
          [buttona2, bitmap`
1111111111111111
1111111111111111
1122222222222211
1121111111111211
1121111221111211
1121112112111211
1121121111211211
1121121111211211
1121122222211211
1121121111211211
1121121111211211
1121121111211211
1121111111111211
1122222222222211
1111111111111111
1111111111111111`],
          [bg, bitmap`
1L1L1L1L1L1L1L1L
L1L1L1L1L1L1L1L1
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1111111111111111
1L1L1L1L1L1L1L1L
L1L1L1L1L1L1L1L1`]);

setBackground("g")

const level = map`
...
urb
lda`;
const levelu = map`
...
1rb
lda`;
const leveld = map`
...
urb
l2a`;
const levell = map`
...
urb
3da`;
const levelr = map`
...
u4b
lda`;
const levelb = map`
...
ur5
lda`;
const levela = map`
...
urb
ld6`;

const neededInput = "uuddlrlrba";
let currentInput, score, status, lost, canPress;

function initGameVars() {
  setMap(level);
  
  currentInput = "";
  
  score = 0;
  status = "Score: "+score;
  
  lost = false;
  canPress = true;

  clearText();
  addText(status, {x: 3,y: 1,color: color`2`});
}

initGameVars();

function onInputUniversal() {
  if(canPress == false) {
    return
  }
  if(lost == true) {
    initGameVars();
  }
}

// inputs for player movement control
onInput("w", () => {
  onInputUniversal()
  currentInput += "u";
  setMap(levelu);
});

onInput("a", () => {
  onInputUniversal()
  currentInput += "l";
  setMap(levell);
});


onInput("s", () => {
  onInputUniversal()
  currentInput += "d";
  setMap(leveld);
});

onInput("d", () => {
  onInputUniversal()
  currentInput += "r";
  setMap(levelr);
});

onInput("k", () => {
  onInputUniversal()
  currentInput += "b";
  setMap(levelb);
});

onInput("l", () => {
  onInputUniversal()
  currentInput += "a";
  setMap(levela);
});

// these get run after every input
afterInput(() => {
  onInputUniversal()
  if(currentInput == neededInput) {
    currentInput = "";
    score += 10;
    status = "Score: "+score+"\n(cheatcode entered)";
  } else if(neededInput.startsWith(currentInput)) {
    score += 1;
    status = "Score: "+score;
  } else {
    status = "Game over!\nScore: "+score
  }
  canPress = false;
  setTimeout(() => {
    setMap(level);
    canPress = true;
  }, 100);
  clearText();
  addText(status, {x: 3,y: 1,color: color`2`});
});
