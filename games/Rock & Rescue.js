/*
@title: Rock & Rescue
@author: Avyukth Emmadi
@tags: []
@addedOn: 2024-00-00
*/

const player = "p"
const man = "m"
const wall = "w" 
const rock = "r" 
const house = "h"
const barrier = "b"

setLegend(
  [ player, bitmap`
...0000000000...
...0000000000...
...0000000000...
......0660......
......0660......
.....066600.....
.....036300.....
.....066600.....
.....055500.....
.....066600.....
.....066660.....
.....006660.....
......0000......
......0..0......
....000..000....
....000..000....` ],
  [ man, bitmap`
....000000......
....0.....0.....
...0.0..0.0.....
...0......0.....
...00.000.0.....
....0000000.....
.....00000......
......000.......
...0...0...0....
..00000000000...
...0...0...0....
.......0........
......000.......
.....00.00......
....00...00.....
....0.....0.....` ],
  [ wall, bitmap`
...DD44DD4D.D4..
..D4DDDDDD4DDDD.
.DDD4D44DDDD4DD.
D4DDDDD44D4DDDD.
DDDD44D4D4DD444.
.DD44DD4D4444...
..D4DDD4DDDD4...
...CCCCCCCC.....
....CCCCCCC.....
....CCCCCCC.....
....CCCCCCC.....
....CCCCCCC.....
...CCCCCCCCC....
..CCCCCCCCCC....
.CCCCCCCCCCCCC..
CCCCCCCCCCCCCCC.` ],
  [ rock, bitmap`
................
................
.....LLLLL1.....
...LLLLLLLLLL...
..1LLL110LLLL...
..LLLL000LLLLL..
..LLLLLLLL11LL..
..L1LLL1LL11LL..
..L10LL1LLLLLL..
..LLLLLL00LLLL..
..LL11LL00LLLL..
...L11LLLLLLL...
...LLLLLLLLLL...
.....LLLLLL.....
................
................` ],
  [ house, bitmap`
................
......0000......
.....00CC00.....
....00CCCC00....
...00CCCCCC00...
..00CCCCCCCC00..
.00CCCCCCCCCC00.
..0CLLCCCCLLC0..
..0CLLCCCCLLC0..
..0CCCCCCCCCC0..
..0CCCCCCCCCC0..
..0CCCCCCCCCC0..
..0CCCC11CCCC0..
..0CCCC10CCCC0..
..0CCCC11CCCC0..
..000000000000..` ],
  [ barrier, bitmap`
00LL00000000LL00
00LL00000000LL00
00LL00000000LL00
00LL00000000LL00
00LL00000000LL00
00LL00000000LL00
00LL00000000LL00
00LL00000000LL00
00LL00000000LL00
00LL00000000LL00
00LL00000000LL00
00LL00000000LL00
00LL00000000LL00
00LL00000000LL00
00LL00000000LL00
00LL00000000LL00` ]
)

setSolids([player, wall, rock, man, barrier])
addText("push the rocks", {x:2, y:0, color:color`2`})
let level = 0;
const levels = [
  map`
bbbbbbbbbbbbbbbbbbbbbbb
b.....................b
b....................wb
b....................wb
b............www..w.w.b
b..r......r...........b
b.......wwww...r..rw..b
b...r.w.w..ww.r...w...b
b.r...w.w.w.w....www..b
b.....w.w...ww..ww.w..b
p.....wrw..r.wwww.....h
b...r.w.w.....w.......b
b....ww.w..........r..b
b..ww.r.w.......w.....b
b.m..wwwwr..w...w...r.b
b..r............w.w...b
b..w......w.....www...b
b..ww...rw.r..........b
b........w............b
bbbbbbbbbwbbbbbbbbbbbbb`,
  map`
............
............
............
............
............
............
............
............
............
............`
];

// Set the initial map using the level array
setMap(levels[level]);

setPushables({
  [player]: [rock, man]
})

onInput("s", () => {
  getFirst(player).y += 1
})
onInput("w", () => {
  getFirst(player).y-= 1
  })
onInput("a", () => {
 getFirst(player).x -= 1 
})  
onInput("d", () => {
   getFirst(player).x+= 1
  })
onInput("j", () => {
  setMap(levels[level])
})

addText("Press J to reset", {x:2, y:7, color:color`6`})
afterInput(() => {
  clearText();
  if(tilesWith(man,house).length >=1) {
    addText("You Won!", {x:7, y:7, color:color`4`});
  }
});